<!DOCTYPE html>
<html lang="en" class="Internet-Draft">
<head>
<meta charset="utf-8">
<meta content="Common,Latin" name="scripts">
<meta content="initial-scale=1.0" name="viewport">
<title>A Concise Binary Object Representation (CBOR) of DNS Messages</title>
<meta content="Martine Sophie Lenders" name="author">
<meta content="Carsten Bormann" name="author">
<meta content="Mikolai Gütschow" name="author">
<meta content="Thomas C. Schmidt" name="author">
<meta content="Matthias Wählisch" name="author">
<meta content="
       This document specifies a compact data format of DNS messages using
the Concise Binary Object Representation  .
The primary purpose is to keep DNS messages small in constrained networks. 
    " name="description">
<meta content="xml2rfc 3.31.0" name="generator">
<meta content="Internet-Draft" name="keyword">
<meta content="CBOR" name="keyword">
<meta content="DNS" name="keyword">
<meta content="draft-lenders-dns-cbor-latest" name="ietf.draft">
<!-- Generator version information:
  xml2rfc 3.31.0
    Python 3.12.12
    ConfigArgParse 1.7
    google-i18n-address 3.1.1
    intervaltree 3.2.1
    Jinja2 3.1.6
    lxml 6.0.2
    platformdirs 4.5.1
    pycountry 24.6.1
    PyYAML 6.0.3
    requests 2.32.5
    wcwidth 0.3.0
-->
<link href="draft-lenders-dns-cbor.xml" rel="alternate" type="application/rfc+xml">
<link href="#copyright" rel="license">
<style type="text/css">@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}

@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-cyrillic.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-cyrillic.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 600;
  font-display: swap;
  src: local('Lora SemiBold'), local('Lora-SemiBold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-semibold-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Oxygen Mono';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Oxygen Mono'), local('OxygenMono-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/oxygenmono-regular-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Oxygen Mono';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Oxygen Mono'), local('OxygenMono-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/oxygenmono-regular-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C8A, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-cyrillic.woff2') format('woff2');
  unicode-range: U+0301, U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-greek.woff2') format('woff2');
  unicode-range: U+0370-0377, U+037A-037F, U+0384-038A, U+038C, U+038E-03A1, U+03A3-03FF;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-02BA, U+02BD-02C5, U+02C7-02CC, U+02CE-02D7, U+02DD-02FF, U+0304, U+0308, U+0329, U+1D00-1DBF, U+1E00-1E9F, U+1EF2-1EFF, U+2020, U+20A0-20AB, U+20AD-20C0, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+0304, U+0308, U+0329, U+2000-206F, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C8A, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-cyrillic.woff2') format('woff2');
  unicode-range: U+0301, U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-greek.woff2') format('woff2');
  unicode-range: U+0370-0377, U+037A-037F, U+0384-038A, U+038C, U+038E-03A1, U+03A3-03FF;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-02BA, U+02BD-02C5, U+02C7-02CC, U+02CE-02D7, U+02DD-02FF, U+0304, U+0308, U+0329, U+1D00-1DBF, U+1E00-1E9F, U+1EF2-1EFF, U+2020, U+20A0-20AB, U+20AD-20C0, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+0304, U+0308, U+0329, U+2000-206F, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

:root {
  color-scheme: light dark;
  --background-color: #fff;
  --text-color: #222;
  --title-color: #191919;
  --link-color: #2a6496;
  --highlight-color: #f9f9f9;
  --line-color: #eee;
  --pilcrow-weak: #ddd;
  --pilcrow-strong: #bbb;
  --small-font-size: 14.5px;
  --font-mono: 'Oxygen Mono', monospace;
  --font-title: "Sofia Sans Semi Condensed", sans-serif;
  scrollbar-color: #bbb #eee;
}
body {
  max-width: 600px;
  margin: 75px auto;
  padding: 0 5px;
  color: var(--text-color);
  background-color: var(--background-color);
  font: 16px/22px "Lora", serif;
  scroll-behavior: smooth;
}

.ears {
  display: none;
}

/* headings */
section {
  clear: both;
}
.section-number {
  padding-right: 0.5em;
}
h1, h2, h3, h4, h5, h6 {
  font-family: var(--font-title);
  font-weight: 680;
  margin: 0.8em 0 0.3em;
  font-size-adjust: 0.5;
  color: var(--title-color);
}
h1#title {
  font-size: 32px;
  line-height: 40px;
  clear: both;
}
h1#title, h1#rfcnum {
  margin: 1.5em 0 0.2em;
}
h1#rfcnum + h1#title {
  margin: 0.2em 0;
}

h1, h2, h3 {
  font-size: 22px;
  line-height: 27px;
}
h4, h5, h6 {
  font-size: 20px;
  line-height: 24px;
}

/* general structure */
.author {
  padding-bottom: 0.3em;
  vertical-align: top;
}
#abstract+p {
  font-size: 18px;
  line-height: 24px;
}
#abstract+p code, #abstract+p samp, #abstract+p tt {
  font-size: 16px;
  line-height: 0;
}

p {
  padding: 0;
  margin: 0.5em 0;
  text-align: left;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: var(--highlight-color);
  border: 1px solid var(--line-color);
  border-radius: 3px;
  padding: 0.5em 1em 0;
  margin-bottom: 0.5em;
}
.alignRight.art-text pre {
  padding: 0;
  width: auto;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
/* font-family isn't space-separated, but =~ will have to do */
svg[font-family~="monospace" i], svg [font-family~="monospace" i] {
  font-family: var(--font-mono);
}
.alignCenter.art-text {
  background-color: var(--highlight-color);
  border: 1px solid var(--line-color);
  border-radius: 3px;
  padding: 0.5em 1em 0;
  margin-bottom: 0.5em;
}
.alignCenter.art-text pre {
  padding: 0;
  width: auto;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  border: none;
  /* this isn't optimal, but it's an existence proof.  PrinceXML doesn't
     support flexbox yet.
  */
  display: table;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 0.5em 2em;
  & :is(ol, ul) {
    margin-left: 1em;
  }
}
li {
  margin: 0 0 0.25em 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
  & li {
    margin-top: 0.5em;
  }
}
:is(ul, ol).compact, .ulCompact, .olCompact {
  margin: 0 0 0 2em;
  & li {
    margin: 0;
    & :first-child { margin-top: 0; }
    & :last-child { margin-bottom: 0; }
  }
}

/* definition lists */
dl {
  clear: left;
  --indent: 3ch;
  /* --indent: attr(indent ch); not supported in any browser, but we can dream */
  &.olPercent {
    --indent: 5ch;
    & > dt {
      min-width: calc(var(--indent) - 2ch);
    }
  }
  &.olPercent > dt {
    float: none;
  }

  dl > dd > & {
    margin-top: 0.5em;
    margin-bottom: 0;
  }
}
dl:not(.dlNewline) > dt {
  float: left;
  margin-right: 2ch;
  min-width: 8ch;
}
dl > dd {
  margin-bottom: .8em;
  margin-left: var(--indent) !important; /* stupid element overrides */
  min-height: 2ex;
}
:is(dl.compact, .dlCompact) > dd {
  margin-bottom: 0;
  & > :is(:first-child, .break:first-child + *) {
    margin-top: 0;
  }
  & > :is(:last-child) {
    margin-bottom: 0;
  }
}
:is(dd, span).break {
  display: none;
}

/* links */
a, a[href].selfRef:hover {
  text-decoration: none;
}
a[href] {
  color: var(--link-color);
}
a[href].selfRef, .iref + a[href].internal {
  color: var(--text-color);
}
a[href]:hover {
  text-decoration: underline;
}
a[href].selfRef:hover {
  background-color: var(--highlight-color);
}
a.xref:is(.cite, .auto), :is(#status-of-memo, #copyright) a {
  white-space: nowrap;
}

/* Figures */
tt, code, pre {
  background-color: var(--highlight-color);
  font: 14px/22px var(--font-mono);
}
tt, code {
  /* changing the font for inline elements leads to different ascender
     and descender heights; as we want to retain baseline alignment,
     remove leading to avoid altering the final height of lines
     note: this fails if these blocks take an entire line,
     a different solution would be great */
  line-height: 0;
}
:is(h1, h2, h3, h4, h5, h6) :is(tt, code) {
  font-size: 84%;
}
pre {
  border: 1px solid var(--line-color);
  font-size: 13.5px;
  line-height: 16px;
  letter-spacing: -0.2px;
  margin: 5px;
  padding: 5px;
}
img {
  max-width: 100%;
}
figure {
  margin: 0.5em 0;
  padding: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption, caption {
  font-style: italic;
  margin: 0.5em 1.5em;
  text-align: left;
  caption-side: bottom;
}
@media screen {
  /* Auto-collapse boilerplate. */
  :is(#status-of-memo, #copyright) p {
    margin: -2px 0;
    max-height: 0;
    transition: max-height 2s ease, margin 0.5s ease 0.5s;
    overflow: hidden;
  }
  :is(#status-of-memo, #copyright):hover p,
  :is(#status-of-memo, #copyright) h2:target ~ p {
    margin: 0.5em 0;
    max-height: 500px;
    overflow: auto;
  }
  pre, svg {
    display: inline-block;
    /* In the horizontal direction, sometimes people make over-sized figures.
       Scrollbars for those is therefore necessary: auto adds them as necessary..
       In the vertical direction, the line-height can combine with the font
       asender/descender height to produce scrollbars: hidden avoids that. */
    overflow: auto hidden;
  }
  pre {
    max-width: 100%;
    width: calc(100% - 22px - 1em);
  }
  svg {
    max-width: calc(100% - 22px - 1em);
  }
  figure pre {
    display: block;
    width: calc(100% - 25px);
  }
  :is(pre, svg) + .pilcrow {
    display: inline-block;
    vertical-align: text-bottom;
    padding-bottom: 8px;
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 0 2em;
  font-style: italic;
}
blockquote {
  margin: 1em 0;
  border-left: 2px var(--pilcrow-strong) solid;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}

/* tables */
table {
  width: auto;
  max-width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
}
table.right {
  margin-left: auto;
}
table.center {
  margin-left: auto;
  margin-right: auto;
}
table.left {
  margin-right: auto;
}
table .text-left {
  text-align: left;
}
table .text-center {
  text-align: center;
}
table .text-right {
  text-align: right;
}

thead, tbody {
  border: 1px solid var(--line-color);
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 5px 10px;
}
th {
  background-color: var(--line-color);
}
:is(tr:nth-child(2n), thead+tbody > tr:nth-child(2n+1)) > td {
  background-color: var(--background-color);
}
:is(tr:nth-child(2n+1), thead+tbody > tr:nth-child(2n)) > td {
  background-color: var(--highlight-color);
}
table caption {
  margin: 0;
  padding: 3px 0 3px 1em;
}
table p {
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  margin-left: 3px;
  opacity: 0.2;
  user-select: none;
  &[href] {
    color: var(--pilcrow-weak);
    &:hover { text-decoration: none; }
  }
}
@media not print {
  :hover > a.pilcrow, a.pilcrow:focus {
    opacity: 1;
  }
  a.pilcrow[href]:hover {
    color: var(--pilcrow-strong);
    background-color: transparent;
  }
}
@media print {
  a.pilcrow {
    display: none;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid var(--line-color);
}
.bcp14 {
  font-variant: small-caps;
  font-weight: 600;
  font-size: var(--small-font-size);
}
.role {
  font-variant: all-small-caps;
}
sub, sup {
  line-height: 1;
  font-size: 80%;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: var(--small-font-size);
  line-height: 18px;
  --identifier-width: 15ch;
  & dt {
    width: var(--identifier-width);
    min-width: var(--identifier-width);
    clear: left;
    float: left;
    text-align: right;
    margin-right: 1ch;
  }
  & dd {
    margin: 0;
    margin-left: calc(1em + var(--identifier-width)) !important;
    min-width: 5em;
  }
  & .authors {
    & .author {
      display: inline-block;
      margin-right: 1.5em;
    }
    & .org {
      font-style: italic;
    }
  }
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #999;
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;

  & nav {
    & ul {
      margin: 0 0.5em 0 0;
      padding: 0;
      list-style: none;
    }
    & li {
      line-height: 1.3em;
      margin: 2px 0;
      padding-left: 1.2em;
      text-indent: -1.2em;
    }
  }
  & a.xref {
    white-space: normal;
  }
}

.references {
  & > dt {
    text-align: right;
    font-weight: bold;
    min-width: 10ch;
    margin-right: 1.5ch;
    &:target::before {
      content: "⇒";
      margin: 0 10px 0 -25px;
    }
  }
  & > dd {
    margin-left: 12ch !important;
    overflow: visible;
    & .refInstance {
      margin-bottom: 0.8em;
    }
    & .ascii {
      margin-bottom: 0.25em;
    }
  }
}

#rfc\.index\.index + ul {
  margin-left: 0;
}

/* authors */
address.vcard {
  font-style: normal;
  max-width: 20em;
  margin: 1em auto 1em 0;

  & .nameRole {
    font-weight: 700;
    margin-left: 0;
  }
  & .label {
    margin: 0.5em 0;
  }
  & .type {
    display: none;
  }
  & .alternative-contact {
    margin: 0.5em 0 0.25em 0;
  }
  & .non-ascii {
    margin: 0 0 0 2em;
  }
  & div.left {
    text-align: left;
  }
  & div.right {
    text-align: right;
  }
}

hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}
@media (min-width: 500px) {
  #authors-addresses > section {
    column-count: 2;
    column-gap: 20px;
  }
  #authors-addresses > section > h2 {
    column-span: all;
  }
  /* hack for break-inside: avoid-column */
  #authors-addresses address {
    display: inline-block;
    break-inside: avoid-column;
  }
}

/* Comments */
.rfcEditorRemove p:first-of-type {
  font-style: italic;
}
.cref {
  background-color: rgba(249, 232, 105, 0.3);
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}

@media screen {
  #toc nav {
    font-family: var(--font-title);
    font-weight: 360;
    & > ul { margin-bottom: 2em; }
    & ul {
      margin: 0 0 0 4px;
      & :is(p, li) {
        margin: 2px 0;
      }
    }
  }
  #toc a.toplink {
    float: right;
  }
}
@media not screen {
  #toc a.toplink {
    display: none;
  }
}


/* TOC layout for smaller screens */
@media screen and (max-width: 929px) {
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 1px 0 0 0;
    margin: 0;
    border-bottom: 1px solid #ccc;
    opacity: 0.6;
  }
  #toc h2 {
    margin: 0;
    padding: 2px 0 2px 6px;
    padding-right: 1em;
    font-size: 18px;
    line-height: 24px;
    min-width: 190px;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
    &::before { /* css hamburger */
      float: right;
      position: relative;
      width: 1em;
      height: 1px;
      left: -164px;
      margin: 8px 0 0 0;
      background: white none repeat scroll 0 0;
      box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
      content: "";
    }
  }
  #toc nav {
    display: none;
    background-color: var(--background-color);
    padding: 0.5em 1em 1em;
    overflow: auto;
    overscroll-behavior: contain;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
  #toc.active {
    opacity: 1;
    & nav { display: block; }
  }
  /* Make the collapsed ToC header render white on gray also when it's a link */
  #toc h2 a,
  #toc h2 a:is(:link, :focus, :hover),
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
  #toc a.toplink {
    margin: 2px 0.5em 0;
  }
}

/* TOC layout for wide screens */
@media screen and (min-width: 930px) {
  body {
    padding-right: 360px;
    padding-right: calc(min(180px + 20%, 500px));
  }
  #toc {
    position: fixed;
    bottom: 0;
    right: 0;
    right: calc(50vw - 480px);
    width: 312px;
    margin: 0;
    padding: 0;
    z-index: 1;
  }
  #toc h2 {
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 2em;
    overflow: auto;
    overscroll-behavior: contain;
    scrollbar-width: thin;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
  #toc a.toplink {
    margin: 8px 0.5em 0;
  }
}

/* pagination */
@media print {
  body {
    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre, .vcard {
    page-break-inside: avoid;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  :is(h2, h3, h4, h5, h6)+*, dd {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
}

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
}

/* Dark mode. */
@media (prefers-color-scheme: dark) {
:root {
  --background-color: #121212;
  --text-color: #f0f0f0;
  --title-color: #fff;
  --link-color: #4da4f0;
  --highlight-color: #282828;
  --line-color: #444;
  --pilcrow-weak: #444;
  --pilcrow-strong: #666;
  scrollbar-color: #777 #333;
}
}

/* SVG Trick: a prefix match works because only black and white are allowed */
svg :is([stroke="black"], [stroke^="#000"]) {
  stroke: var(--text-color);
}
svg :is([stroke="white"], [stroke^="#fff"]) {
  stroke: var(--background-color);
}
svg :is([fill="black"], [fill^="#000"], :not([fill])) {
  fill: var(--text-color);
}
svg :is([fill="white"], [fill^="#fff"]) {
  fill: var(--background-color);
}
</style>

</head>
<body class="xml2rfc">
<table class="ears">
<thead><tr>
<td class="left">Internet-Draft</td>
<td class="center">dns+cbor</td>
<td class="right">February 2026</td>
</tr></thead>
<tfoot><tr>
<td class="left">Lenders, et al.</td>
<td class="center">Expires 8 August 2026</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div id="external-metadata" class="document-information"></div>
<div id="internal-metadata" class="document-information">
<dl id="identifiers">
<dt class="label-workgroup">Workgroup:</dt>
<dd class="workgroup">CBOR</dd>
<dt class="label-internet-draft">Internet-Draft:</dt>
<dd class="internet-draft">draft-lenders-dns-cbor-latest</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time datetime="2026-02-04" class="published">4 February 2026</time>
    </dd>
<dt class="label-intended-status">Intended Status:</dt>
<dd class="intended-status">Standards Track</dd>
<dt class="label-expires">Expires:</dt>
<dd class="expires"><time datetime="2026-08-08">8 August 2026</time></dd>
<dt class="label-authors">Authors:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">M. S. Lenders</div>
<div class="org">TU Dresden</div>
</div>
<div class="author">
      <div class="author-name">C. Bormann</div>
<div class="org">Universität Bremen TZI</div>
</div>
<div class="author">
      <div class="author-name">M. Gütschow</div>
<div class="org">TU Dresden</div>
</div>
<div class="author">
      <div class="author-name">T. C. Schmidt</div>
<div class="org">HAW Hamburg</div>
</div>
<div class="author">
      <div class="author-name">M. Wählisch</div>
<div class="org">TU Dresden &amp; Barkhausen Institut</div>
</div>
</dd>
</dl>
</div>
<h1 id="title">A Concise Binary Object Representation (CBOR) of DNS Messages</h1>
<section id="section-abstract">
      <h2 id="abstract"><a href="#abstract" class="selfRef">Abstract</a></h2>
<p id="section-abstract-1">This document specifies a compact data format of DNS messages using
the Concise Binary Object Representation <span>[<a href="#RFC8949" class="cite xref">RFC8949</a>]</span>.
The primary purpose is to keep DNS messages small in constrained networks.<a href="#section-abstract-1" class="pilcrow">¶</a></p>
</section>
<section class="note rfcEditorRemove" id="section-note.1">
      <h2 id="name-about-this-document">
<a href="#name-about-this-document" class="section-name selfRef">About This Document</a>
      </h2>
<p id="section-note.1-1">This note is to be removed before publishing as an RFC.<a href="#section-note.1-1" class="pilcrow">¶</a></p>
<p id="section-note.1-2">
        The latest revision of this draft can be found at <span><a href="https://cbor-wg.github.io/cbor-dns/draft-lenders-dns-cbor.html">https://cbor-wg.github.io/cbor-dns/draft-lenders-dns-cbor.html</a></span>.
        Status information for this document may be found at <span><a href="https://datatracker.ietf.org/doc/draft-lenders-dns-cbor/">https://datatracker.ietf.org/doc/draft-lenders-dns-cbor/</a></span>.<a href="#section-note.1-2" class="pilcrow">¶</a></p>
<p id="section-note.1-3">
        Discussion of this document takes place on the
        CBOR Working Group mailing list (<span><a href="mailto:cbor@ietf.org">mailto:cbor@ietf.org</a></span>),
        which is archived at <span><a href="https://mailarchive.ietf.org/arch/browse/cbor/">https://mailarchive.ietf.org/arch/browse/cbor/</a></span>.
        Subscribe at <span><a href="https://www.ietf.org/mailman/listinfo/cbor/">https://www.ietf.org/mailman/listinfo/cbor/</a></span>.<a href="#section-note.1-3" class="pilcrow">¶</a></p>
<p id="section-note.1-4">Source for this draft and an issue tracker can be found at
        <span><a href="https://github.com/cbor-wg/cbor-dns">https://github.com/cbor-wg/cbor-dns</a></span>.<a href="#section-note.1-4" class="pilcrow">¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo">
<a href="#name-status-of-this-memo" class="section-name selfRef">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
        This Internet-Draft is submitted in full conformance with the
        provisions of BCP 78 and BCP 79.<a href="#section-boilerplate.1-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-2">
        Internet-Drafts are working documents of the Internet Engineering Task
        Force (IETF). Note that other groups may also distribute working
        documents as Internet-Drafts. The list of current Internet-Drafts is
        at <span><a href="https://datatracker.ietf.org/drafts/current/">https://datatracker.ietf.org/drafts/current/</a></span>.<a href="#section-boilerplate.1-2" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-3">
        Internet-Drafts are draft documents valid for a maximum of six months
        and may be updated, replaced, or obsoleted by other documents at any
        time. It is inappropriate to use Internet-Drafts as reference
        material or to cite them other than as "work in progress."<a href="#section-boilerplate.1-3" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-4">
        This Internet-Draft will expire on 8 August 2026.<a href="#section-boilerplate.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice">
<a href="#name-copyright-notice" class="section-name selfRef">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2026 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a href="#section-boilerplate.2-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document. Code Components extracted from this
            document must include Revised BSD License text as described in
            Section 4.e of the Trust Legal Provisions and are provided without
            warranty as described in the Revised BSD License.<a href="#section-boilerplate.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a href="#" onclick="scroll(0,0)" class="toplink">▲</a><h2 id="name-table-of-contents">
<a href="#name-table-of-contents" class="section-name selfRef">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1">
            <p id="section-toc.1-1.1.1" class="keepWithNext"><a href="#section-1" class="auto internal xref">1</a>.  <a href="#name-introduction" class="internal xref">Introduction</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2">
            <p id="section-toc.1-1.2.1" class="keepWithNext"><a href="#section-2" class="auto internal xref">2</a>.  <a href="#name-terminology-and-conventions" class="internal xref">Terminology and Conventions</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1"><a href="#section-3" class="auto internal xref">3</a>.  <a href="#name-cbor-representations-applic" class="internal xref">CBOR Representations (application/dns+cbor)</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.1">
                <p id="section-toc.1-1.3.2.1.1" class="keepWithNext"><a href="#section-3.1" class="auto internal xref">3.1</a>.  <a href="#name-domain-name-representation" class="internal xref">Domain Name Representation</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.2">
                <p id="section-toc.1-1.3.2.2.1"><a href="#section-3.2" class="auto internal xref">3.2</a>.  <a href="#name-dns-resource-records" class="internal xref">DNS Resource Records</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.2.2.1">
                    <p id="section-toc.1-1.3.2.2.2.1.1"><a href="#section-3.2.1" class="auto internal xref">3.2.1</a>.  <a href="#name-standard-rrs" class="internal xref">Standard RRs</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.2.2.2">
                    <p id="section-toc.1-1.3.2.2.2.2.1"><a href="#section-3.2.2" class="auto internal xref">3.2.2</a>.  <a href="#name-edns-opt-pseudo-rrs" class="internal xref">EDNS OPT Pseudo-RRs</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.3">
                <p id="section-toc.1-1.3.2.3.1"><a href="#section-3.3" class="auto internal xref">3.3</a>.  <a href="#name-dns-queries" class="internal xref">DNS Queries</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.4">
                <p id="section-toc.1-1.3.2.4.1"><a href="#section-3.4" class="auto internal xref">3.4</a>.  <a href="#name-dns-responses" class="internal xref">DNS Responses</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a href="#section-4" class="auto internal xref">4</a>.  <a href="#name-compression-with-packed-cbo" class="internal xref">Compression with Packed CBOR</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.1">
                <p id="section-toc.1-1.4.2.1.1"><a href="#section-4.1" class="auto internal xref">4.1</a>.  <a href="#name-name-compression" class="internal xref">Name Compression</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2">
                <p id="section-toc.1-1.4.2.2.1"><a href="#section-4.2" class="auto internal xref">4.2</a>.  <a href="#name-further-dns-representation-" class="internal xref">Further DNS Representation with Tag 113</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.3">
                <p id="section-toc.1-1.4.2.3.1"><a href="#section-4.3" class="auto internal xref">4.3</a>.  <a href="#name-media-type-negotiation" class="internal xref">Media Type Negotiation</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.4">
                <p id="section-toc.1-1.4.2.4.1"><a href="#section-4.4" class="auto internal xref">4.4</a>.  <a href="#name-compression" class="internal xref">Compression</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a href="#section-5" class="auto internal xref">5</a>.  <a href="#name-implementation-status" class="internal xref">Implementation Status</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.1">
                <p id="section-toc.1-1.5.2.1.1"><a href="#section-5.1" class="auto internal xref">5.1</a>.  <a href="#name-python-decoder-encoder" class="internal xref">Python decoder/encoder</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2">
                <p id="section-toc.1-1.5.2.2.1"><a href="#section-5.2" class="auto internal xref">5.2</a>.  <a href="#name-embedded-decoder-encoder" class="internal xref">Embedded decoder/encoder</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a href="#section-6" class="auto internal xref">6</a>.  <a href="#name-security-considerations" class="internal xref">Security Considerations</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a href="#section-7" class="auto internal xref">7</a>.  <a href="#name-iana-considerations" class="internal xref">IANA Considerations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.1">
                <p id="section-toc.1-1.7.2.1.1"><a href="#section-7.1" class="auto internal xref">7.1</a>.  <a href="#name-media-type-registration" class="internal xref">Media Type Registration</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.1.2.1">
                    <p id="section-toc.1-1.7.2.1.2.1.1"><a href="#section-7.1.1" class="auto internal xref">7.1.1</a>.  <a href="#name-application-dnscbor" class="internal xref">"application/dns+cbor"</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.2">
                <p id="section-toc.1-1.7.2.2.1"><a href="#section-7.2" class="auto internal xref">7.2</a>.  <a href="#name-coap-content-format-registr" class="internal xref">CoAP Content-Format Registration</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.2.2.1">
                    <p id="section-toc.1-1.7.2.2.2.1.1"><a href="#section-7.2.1" class="auto internal xref">7.2.1</a>.  <a href="#name-application-dnscbor-2" class="internal xref">"application/dns+cbor"</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.2.2.2">
                    <p id="section-toc.1-1.7.2.2.2.2.1"><a href="#section-7.2.2" class="auto internal xref">7.2.2</a>.  <a href="#name-application-dnscborpacked1" class="internal xref">"application/dns+cbor;packed=1"</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.3">
                <p id="section-toc.1-1.7.2.3.1"><a href="#section-7.3" class="auto internal xref">7.3</a>.  <a href="#name-cbor-tags-registry" class="internal xref">CBOR Tags Registry</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a href="#section-8" class="auto internal xref">8</a>.  <a href="#name-examples" class="internal xref">Examples</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.1">
                <p id="section-toc.1-1.8.2.1.1"><a href="#section-8.1" class="auto internal xref">8.1</a>.  <a href="#name-cddl-model-for-e-applicatio" class="internal xref">CDDL model for <code>e''</code> application extension</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.2">
                <p id="section-toc.1-1.8.2.2.1"><a href="#section-8.2" class="auto internal xref">8.2</a>.  <a href="#name-dns-queries-2" class="internal xref">DNS Queries</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.3">
                <p id="section-toc.1-1.8.2.3.1"><a href="#section-8.3" class="auto internal xref">8.3</a>.  <a href="#name-name-compression-2" class="internal xref">Name Compression</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.4">
                <p id="section-toc.1-1.8.2.4.1"><a href="#section-8.4" class="auto internal xref">8.4</a>.  <a href="#name-dns-responses-2" class="internal xref">DNS Responses</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.5">
                <p id="section-toc.1-1.8.2.5.1"><a href="#section-8.5" class="auto internal xref">8.5</a>.  <a href="#name-name-compression-and-packed" class="internal xref">Name Compression and Packed CBOR</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.5.2.1">
                    <p id="section-toc.1-1.8.2.5.2.1.1"><a href="#section-8.5.1" class="auto internal xref">8.5.1</a>.  <a href="#name-example-decoder" class="internal xref">Example Decoder</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9">
            <p id="section-toc.1-1.9.1"><a href="#section-9" class="auto internal xref">9</a>.  <a href="#name-comparison-to-classic-dns-w" class="internal xref">Comparison to Classic DNS Wire Format</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10">
            <p id="section-toc.1-1.10.1"><a href="#section-10" class="auto internal xref">10</a>. <a href="#name-change-log" class="internal xref">Change Log</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.1">
                <p id="section-toc.1-1.10.2.1.1"><a href="#section-10.1" class="auto internal xref">10.1</a>.  <a href="#name-since-draft-lenders-dns-cbo" class="internal xref">Since draft-lenders-dns-cbor-15</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.2">
                <p id="section-toc.1-1.10.2.2.1"><a href="#section-10.2" class="auto internal xref">10.2</a>.  <a href="#name-since-draft-lenders-dns-cbor" class="internal xref">Since draft-lenders-dns-cbor-14</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.3">
                <p id="section-toc.1-1.10.2.3.1"><a href="#section-10.3" class="auto internal xref">10.3</a>.  <a href="#name-since-draft-lenders-dns-cbor-" class="internal xref">Since draft-lenders-dns-cbor-13</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.4">
                <p id="section-toc.1-1.10.2.4.1"><a href="#section-10.4" class="auto internal xref">10.4</a>.  <a href="#name-since-draft-lenders-dns-cbor-1" class="internal xref">Since draft-lenders-dns-cbor-12</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.5">
                <p id="section-toc.1-1.10.2.5.1"><a href="#section-10.5" class="auto internal xref">10.5</a>.  <a href="#name-since-draft-lenders-dns-cbor-11" class="internal xref">Since draft-lenders-dns-cbor-11</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.6">
                <p id="section-toc.1-1.10.2.6.1"><a href="#section-10.6" class="auto internal xref">10.6</a>.  <a href="#name-since-draft-lenders-dns-cbor-10" class="internal xref">Since draft-lenders-dns-cbor-10</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.7">
                <p id="section-toc.1-1.10.2.7.1"><a href="#section-10.7" class="auto internal xref">10.7</a>.  <a href="#name-since-draft-lenders-dns-cbor-0" class="internal xref">Since draft-lenders-dns-cbor-09</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.8">
                <p id="section-toc.1-1.10.2.8.1"><a href="#section-10.8" class="auto internal xref">10.8</a>.  <a href="#name-since-draft-lenders-dns-cbor-08" class="internal xref">Since draft-lenders-dns-cbor-08</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.9">
                <p id="section-toc.1-1.10.2.9.1"><a href="#section-10.9" class="auto internal xref">10.9</a>.  <a href="#name-since-draft-lenders-dns-cbor-07" class="internal xref">Since draft-lenders-dns-cbor-07</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.10">
                <p id="section-toc.1-1.10.2.10.1"><a href="#section-10.10" class="auto internal xref">10.10</a>. <a href="#name-since-draft-lenders-dns-cbor-06" class="internal xref">Since draft-lenders-dns-cbor-06</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.11">
                <p id="section-toc.1-1.10.2.11.1"><a href="#section-10.11" class="auto internal xref">10.11</a>. <a href="#name-since-draft-lenders-dns-cbor-05" class="internal xref">Since draft-lenders-dns-cbor-05</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.12">
                <p id="section-toc.1-1.10.2.12.1"><a href="#section-10.12" class="auto internal xref">10.12</a>. <a href="#name-since-draft-lenders-dns-cbor-04" class="internal xref">Since draft-lenders-dns-cbor-04</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.13">
                <p id="section-toc.1-1.10.2.13.1"><a href="#section-10.13" class="auto internal xref">10.13</a>. <a href="#name-since-draft-lenders-dns-cbor-03" class="internal xref">Since draft-lenders-dns-cbor-03</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.14">
                <p id="section-toc.1-1.10.2.14.1"><a href="#section-10.14" class="auto internal xref">10.14</a>. <a href="#name-since-draft-lenders-dns-cbor-02" class="internal xref">Since draft-lenders-dns-cbor-02</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.15">
                <p id="section-toc.1-1.10.2.15.1"><a href="#section-10.15" class="auto internal xref">10.15</a>. <a href="#name-since-draft-lenders-dns-cbor-01" class="internal xref">Since draft-lenders-dns-cbor-01</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.16">
                <p id="section-toc.1-1.10.2.16.1"><a href="#section-10.16" class="auto internal xref">10.16</a>. <a href="#name-since-draft-lenders-dns-cbor-00" class="internal xref">Since draft-lenders-dns-cbor-00</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11">
            <p id="section-toc.1-1.11.1"><a href="#section-11" class="auto internal xref"></a><a href="#name-acknowledgments" class="internal xref">Acknowledgments</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12">
            <p id="section-toc.1-1.12.1"><a href="#section-12" class="auto internal xref"></a><a href="#name-references" class="internal xref">References</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12.2.1">
                <p id="section-toc.1-1.12.2.1.1"><a href="#section-12.1" class="auto internal xref"></a><a href="#name-normative-references" class="internal xref">Normative References</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12.2.2">
                <p id="section-toc.1-1.12.2.2.1"><a href="#section-12.2" class="auto internal xref"></a><a href="#name-informative-references" class="internal xref">Informative References</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13">
            <p id="section-toc.1-1.13.1"><a href="#appendix-A" class="auto internal xref"></a><a href="#name-contributors" class="internal xref">Contributors</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.14">
            <p id="section-toc.1-1.14.1"><a href="#appendix-B" class="auto internal xref"></a><a href="#name-authors-addresses" class="internal xref">Authors' Addresses</a></p>
</li>
        </ul>
</nav>
</section>
</div>
<div id="introduction">
<section id="section-1">
      <h2 id="name-introduction">
<a href="#section-1" class="section-number selfRef">1. </a><a href="#name-introduction" class="section-name selfRef">Introduction</a>
      </h2>
<p id="section-1-1">In constrained networks <span>[<a href="#RFC7228" class="cite xref">RFC7228</a>]</span>, the link layer may restrict the payload sizes of frames to
only a few hundreds bytes.  Encrypted DNS resolution, such as DNS over HTTPS (DoH) <span>[<a href="#RFC8484" class="cite xref">RFC8484</a>]</span> or
DNS over CoAP (DoC) <span>[<a href="#I-D.ietf-core-dns-over-coap" class="cite xref">I-D.ietf-core-dns-over-coap</a>]</span>, may lead to DNS message sizes that exceed this limit, even when
implementing header compression such as 6LoWPAN IPHC <span>[<a href="#RFC6282" class="cite xref">RFC6282</a>]</span> or SCHC <span>[<a href="#RFC8724" class="cite xref">RFC8724</a>]</span>,
<span>[<a href="#RFC8824" class="cite xref">RFC8824</a>]</span>.<a href="#section-1-1" class="pilcrow">¶</a></p>
<p id="section-1-2">Although adoption layers such as 6LoWPAN <span>[<a href="#RFC4944" class="cite xref">RFC4944</a>]</span> or SCHC <span>[<a href="#RFC8724" class="cite xref">RFC8724</a>]</span> offer fragmentation to
comply with small MTUs, fragmentation should be avoided in constrained networks.
Fragmentation combined with high packet loss multiplies the likelihood of loss.
Hence, a compression format that reduces fragmentation of DNS messages is beneficial.<a href="#section-1-2" class="pilcrow">¶</a></p>
<p id="section-1-3">This document specifies a compact data format for DNS messages using Concise Binary Object Representation (CBOR) <span>[<a href="#RFC8949" class="cite xref">RFC8949</a>]</span> encoding. Additionally,  unnecessary or redundant information are stripped off DNS messages.  To use the outcome of this specification in DoH and DoC,
this document also specifies a Media Type header for DoH and a Content-Format option for DoC.<a href="#section-1-3" class="pilcrow">¶</a></p>
<p id="section-1-4">Note, that there is another format that expresses DNS messages in CBOR, C-DNS <span>[<a href="#RFC8618" class="cite xref">RFC8618</a>]</span>.
C-DNS is primarily a file format to minimize traces of multiple DNS messages and uses the fact that there are multiple messages to do its compression.
Common values such as names or addresses are collected in separate tables which are referenced from the messages, comparable to Packed CBOR <span>[<a href="#I-D.ietf-cbor-packed" class="cite xref">I-D.ietf-cbor-packed</a>]</span>.
However, this may add overhead for individual DNS messages.<a href="#section-1-4" class="pilcrow">¶</a></p>
<p id="section-1-5">The format described in this document is a transfer format that aims to provide conciseness and compression for individual DNS messages to be sent over the network.
This is achieved applying the following objectives:<a href="#section-1-5" class="pilcrow">¶</a></p>
<p id="section-1-6">Conciseness:<a href="#section-1-6" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1-7.1">
          <p id="section-1-7.1.1">Encoding DNS messages in CBOR and<a href="#section-1-7.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-1-7.2">
          <p id="section-1-7.2.1">Omitting (redundant) fields in DNS queries and responses.<a href="#section-1-7.2.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<p id="section-1-8">Compression:<a href="#section-1-8" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1-9.1">
          <p id="section-1-9.1.1">Providing easy to implement name compression that allows for on-the-fly construction of DNS queries and responses and<a href="#section-1-9.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-1-9.2">
          <p id="section-1-9.2.1">Providing optional address and value compression in DNS responses using Packed CBOR <span>[<a href="#I-D.ietf-cbor-packed" class="cite xref">I-D.ietf-cbor-packed</a>]</span>.<a href="#section-1-9.2.1" class="pilcrow">¶</a></p>
</li>
      </ul>
</section>
</div>
<div id="terminology-and-conventions">
<section id="section-2">
      <h2 id="name-terminology-and-conventions">
<a href="#section-2" class="section-number selfRef">2. </a><a href="#name-terminology-and-conventions" class="section-name selfRef">Terminology and Conventions</a>
      </h2>
<p id="section-2-1">CBOR types (unsigned integer, byte string, text string, arrays, etc.) are used as defined in
<span>[<a href="#RFC8949" class="cite xref">RFC8949</a>]</span>.<a href="#section-2-1" class="pilcrow">¶</a></p>
<p id="section-2-2">The terms "DNS server", "DNS client", and "(DNS) resolver" are used as defined in <span>[<a href="#RFC8499" class="cite xref">RFC8499</a>]</span>.<a href="#section-2-2" class="pilcrow">¶</a></p>
<p id="section-2-3">A DNS query is a message that queries DNS information from an upstream DNS resolver.
The reply to that is a DNS response.<a href="#section-2-3" class="pilcrow">¶</a></p>
<p id="section-2-4">The DNS message format specified in <span>[<a href="#RFC1035" class="cite xref">RFC1035</a>]</span> for DNS over UDP we call "classic DNS format" throughout this document or refer to it by its media type "application/dns-message" as specified in <span>[<a href="#RFC8484" class="cite xref">RFC8484</a>]</span>.<a href="#section-2-4" class="pilcrow">¶</a></p>
<p id="section-2-5">The term "constrained networks" is used as defined in <span>[<a href="#RFC7228" class="cite xref">RFC7228</a>]</span>.<a href="#section-2-5" class="pilcrow">¶</a></p>
<p id="section-2-6">The key words "<span class="bcp14">MUST</span>", "<span class="bcp14">MUST NOT</span>", "<span class="bcp14">REQUIRED</span>", "<span class="bcp14">SHALL</span>", "<span class="bcp14">SHALL NOT</span>", "<span class="bcp14">SHOULD</span>", "<span class="bcp14">SHOULD NOT</span>", "<span class="bcp14">RECOMMENDED</span>", "<span class="bcp14">NOT RECOMMENDED</span>",
"<span class="bcp14">MAY</span>", and "<span class="bcp14">OPTIONAL</span>" in this document are to be interpreted as
described in BCP 14 <span>[<a href="#RFC2119" class="cite xref">RFC2119</a>]</span> <span>[<a href="#RFC8174" class="cite xref">RFC8174</a>]</span> when, and only when, they
appear in all capitals, as shown here.<a href="#section-2-6" class="pilcrow">¶</a></p>
<p id="section-2-7">To define the representation of binary objects we use the Concise Data Definition Language (CDDL) <span>[<a href="#RFC8610" class="cite xref">RFC8610</a>]</span>.
For examples, we use the CBOR Extended Diagnostic Notation <span>[<a href="#I-D.ietf-cbor-edn-literals" class="cite xref">I-D.ietf-cbor-edn-literals</a>]</span> with the <code>e''</code> application extension <span>[<a href="#I-D.ietf-cbor-edn-e-ref" class="cite xref">I-D.ietf-cbor-edn-e-ref</a>]</span>.<a href="#section-2-7" class="pilcrow">¶</a></p>
</section>
</div>
<div id="cbor-representations-applicationdnscbor">
<section id="section-3">
      <h2 id="name-cbor-representations-applic">
<a href="#section-3" class="section-number selfRef">3. </a><a href="#name-cbor-representations-applic" class="section-name selfRef">CBOR Representations (application/dns+cbor)</a>
      </h2>
<p id="section-3-1">DNS messages in "application/dns+cbor" are represented as CBOR arrays to minimize overhead.
All CBOR items used in this specification are of definite length.
CBOR arrays that do not follow the length definitions of this or of follow-up specifications, <span class="bcp14">MUST</span> be silently ignored.
CBOR arrays that exceed the message size provided by the transport, <span class="bcp14">MUST</span> be silently ignored.
It is assumed that DNS query and DNS response are distinguished message types and that the query can be mapped to the response by the transfer protocol of choice.<a href="#section-3-1" class="pilcrow">¶</a></p>
<span id="name-this-document-defines-both-"></span><div id="fig_dns-msg">
<figure id="figure-1">
        <div class="lang-cddl sourcecode" id="section-3-2.1">
<pre>
dns-message = dns-query / dns-response
</pre>
</div>
<figcaption><a href="#figure-1" class="selfRef">Figure 1</a>:
<a href="#name-this-document-defines-both-" class="selfRef">This document defines both DNS Queries and Responses in CDDL</a>
        </figcaption></figure>
</div>
<p id="section-3-3">If, for any reason, a DNS message cannot be represented in the CBOR format specified in this document, or if unreasonable overhead is introduced, a fallback to another DNS message format, e.g., the classic DNS format specified in <span>[<a href="#RFC1035" class="cite xref">RFC1035</a>]</span>, <span class="bcp14">MUST</span> always be possible.<a href="#section-3-3" class="pilcrow">¶</a></p>
<div id="sec_domain-names">
<section id="section-3.1">
        <h3 id="name-domain-name-representation">
<a href="#section-3.1" class="section-number selfRef">3.1. </a><a href="#name-domain-name-representation" class="section-name selfRef">Domain Name Representation</a>
        </h3>
<p id="section-3.1-1">Domain names are represented by a sequence of one or more (unicode) text strings.
For instance, "example.org" would be represented as <code>"example","org"</code> in CBOR diagnostic notation.
The root domain "." is represented as an empty string <code>""</code>.
The absence of any label means the name is elided.
For the purpose of this document, domain names remain case-insensitive as specified in <span>[<a href="#RFC1035" class="cite xref">RFC1035</a>]</span>.<a href="#section-3.1-1" class="pilcrow">¶</a></p>
<p id="section-3.1-2">The representation of a domain name is defined in <a href="#fig_domain-name" class="auto internal xref">Figure 2</a>.
A label may either be encoded in ASCII-compatible encoding (ACE) <span>[<a href="#RFC5891" class="cite xref">RFC5891</a>]</span> embedded within UTF-8 encoding of the text strings or plain UTF-8.
It is <span class="bcp14">RECOMMENDED</span> to use the encoding with the shorter length in bytes, otherwise message sizes may
increase.
A decoder identifies the ACE encoding by identifying the label as a valid A-label (see <span>[<a href="#RFC5891" class="cite xref">RFC5891</a>]</span>) and <span class="bcp14">MUST</span> assume the label to be encoded in UTF-8 otherwise.<a href="#section-3.1-2" class="pilcrow">¶</a></p>
<p id="section-3.1-3">This sequence of text strings is supposed to be embedded into a surrounding array, usually the query
or resource record.<a href="#section-3.1-3" class="pilcrow">¶</a></p>
<p id="section-3.1-4">Name compression is implemented using an extension to Packed CBOR, see <a href="#sec_name-compression" class="auto internal xref">Section 4.1</a>.
For readers unfamiliar with Packed CBOR this name compression can be abstracted to a name
compression similar to that described in <span><a href="https://rfc-editor.org/rfc/rfc1035#section-4.1.4" class="relref">Section 4.1.4</a> of [<a href="#RFC1035" class="cite xref">RFC1035</a>]</span>.
However, instead of using the byte index as reference within the message, text strings are counted,
starting at 0, depth-first within the message.
That number is used as index for the reference.
Since names are the only text strings in a CBOR-based DNS message, the end of a name can be identified when the decoder cursor
does not point to a text string or reference to another text string anymore.
For the reference itself, either simple values or tag 6 are used (see <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-cbor-packed-19#section-2.2" class="relref">Section 2.2</a> of [<a href="#I-D.ietf-cbor-packed" class="cite xref">I-D.ietf-cbor-packed</a>]</span>).<a href="#section-3.1-4" class="pilcrow">¶</a></p>
<span id="name-domain-name-definition"></span><div id="fig_domain-name">
<figure id="figure-2">
          <div class="lang-cddl sourcecode" id="section-3.1-5.1">
<pre>
domain-name = ( *label )
label = tstr
</pre>
</div>
<figcaption><a href="#figure-2" class="selfRef">Figure 2</a>:
<a href="#name-domain-name-definition" class="selfRef">Domain Name Definition</a>
          </figcaption></figure>
</div>
</section>
</div>
<div id="sec_rr">
<section id="section-3.2">
        <h3 id="name-dns-resource-records">
<a href="#section-3.2" class="section-number selfRef">3.2. </a><a href="#name-dns-resource-records" class="section-name selfRef">DNS Resource Records</a>
        </h3>
<p id="section-3.2-1">This document specifies the representation of both standard DNS resource records (RRs, see <span>[<a href="#RFC1035" class="cite xref">RFC1035</a>]</span>)
and EDNS option pseudo-RRs (see <span>[<a href="#RFC6891" class="cite xref">RFC6891</a>]</span>.
If for any reason, a resource record cannot be represented in the given formats, they can be
represented in their binary wire-format form as a byte string.<a href="#section-3.2-1" class="pilcrow">¶</a></p>
<p id="section-3.2-2">Further special records, e.g., TSIG <span>[<a href="#RFC8945" class="cite xref">RFC8945</a>]</span>, can be defined in follow-up specifications using the <code>$$structured-ts-rd</code>
extension point (see <a href="#fig_dns-standard-rr" class="auto internal xref">Figure 4</a>) and are out of scope of this document.<a href="#section-3.2-2" class="pilcrow">¶</a></p>
<p id="section-3.2-3">The representation of a DNS resource records is defined in <a href="#fig_dns-rr" class="auto internal xref">Figure 3</a>.<a href="#section-3.2-3" class="pilcrow">¶</a></p>
<span id="name-dns-resource-record-definit"></span><div id="fig_dns-rr">
<figure id="figure-3">
          <div class="lang-cddl sourcecode" id="section-3.2-4.1">
<pre>
$$dns-rr = rr / #6.141(opt-rr) / bstr
</pre>
</div>
<figcaption><a href="#figure-3" class="selfRef">Figure 3</a>:
<a href="#name-dns-resource-record-definit" class="selfRef">DNS Resource Record Definition</a>
          </figcaption></figure>
</div>
<div id="standard-rrs">
<section id="section-3.2.1">
          <h4 id="name-standard-rrs">
<a href="#section-3.2.1" class="section-number selfRef">3.2.1. </a><a href="#name-standard-rrs" class="section-name selfRef">Standard RRs</a>
          </h4>
<p id="section-3.2.1-1">Standard DNS resource records are encoded as CBOR arrays containing 2 or more entries in the following order:<a href="#section-3.2.1-1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-3.2.1-2">
<li id="section-3.2.1-2.1">
              <p id="section-3.2.1-2.1.1">An optional name (as text string, see <a href="#sec_domain-names" class="auto internal xref">Section 3.1</a>),<a href="#section-3.2.1-2.1.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-3.2.1-2.2">
              <p id="section-3.2.1-2.2.1">A TTL (as unsigned integer),<a href="#section-3.2.1-2.2.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-3.2.1-2.3">
              <p id="section-3.2.1-2.3.1">An optional record type (as unsigned integer),<a href="#section-3.2.1-2.3.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-3.2.1-2.4">
              <p id="section-3.2.1-2.4.1">An optional record class (as unsigned integer), and lastly<a href="#section-3.2.1-2.4.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-3.2.1-2.5">
              <p id="section-3.2.1-2.5.1">A record data entry (as byte string, domain name, or array for dedicated record data representation) or
a boolean (true) that indicates that the resource record is actually a resource record set with
an array of one or more record data entries following. In the latter case, individual domain
names need to be put into their own array.<a href="#section-3.2.1-2.5.1" class="pilcrow">¶</a></p>
</li>
          </ol>
<p id="section-3.2.1-3">If the first item of the resource record is a text string, it is the first label of a domain name (see <a href="#sec_domain-names" class="auto internal xref">Section 3.1</a>).
If the name is elided, the name is derived from the question section of the message.
For responses, the question section is either taken from the query (see <a href="#sec_queries" class="auto internal xref">Section 3.3</a>) or provided with the response see <a href="#sec_responses" class="auto internal xref">Section 3.4</a>.
The query may be derived from the context of the transfer protocol.<a href="#section-3.2.1-3" class="pilcrow">¶</a></p>
<p id="section-3.2.1-4">If the record type is elided, the record type from the question is assumed.
If record class is elided, the record class from the question is assumed.
When a record class is required to be expressed, the record type <span class="bcp14">MUST</span> also be provided.<a href="#section-3.2.1-4" class="pilcrow">¶</a></p>
<p id="section-3.2.1-5">The byte string format of the record data as a byte string follows the classic DNS format as specified in <span><a href="https://rfc-editor.org/rfc/rfc1035#section-3.3" class="relref">Section 3.3</a> of [<a href="#RFC1035" class="cite xref">RFC1035</a>]</span> (or other specifications of the respective record type).
Note that the CBOR format does not include the RDLENGTH field from the classic format as this value is encoded in the length field of the CBOR header of the byte string.<a href="#section-3.2.1-5" class="pilcrow">¶</a></p>
<p id="section-3.2.1-6">If the record data represents a domain name (e.g., for CNAME or PTR records), the record data <span class="bcp14">MAY</span> be represented as domain name as specified in <a href="#sec_domain-names" class="auto internal xref">Section 3.1</a>.
This way of representing the record data means that name compression (see <a href="#sec_name-compression" class="auto internal xref">Section 4.1</a>) can also be used on it.<a href="#section-3.2.1-6" class="pilcrow">¶</a></p>
<p id="section-3.2.1-7">Depending on the record type, the record data may also be expressed as an array.
Some initial array types are specified below.
Future specifications can extend the definition for <code>$$structured-ts-rd</code> in <a href="#fig_dns-standard-rr" class="auto internal xref">Figure 4</a>.
Extensions to that in this document mainly serve to expose names to name compression (see <a href="#sec_name-compression" class="auto internal xref">Section 4.1</a>).
There is an argument to be made for CBOR-structured formats of other record data representations (e.g. DNSKEY or RRSIG), but structuring such records as an array usually adds more overhead than just transferring the byte representation.
As such, structured record data that do not contain names are to be represented as a byte string in this specification.<a href="#section-3.2.1-7" class="pilcrow">¶</a></p>
<p id="section-3.2.1-8">Multiple resource records of the same type, class, and TTL can be summarized to a resource record set.
A decoder can be notified about this, by including the boolean true value before an array of multiple record data entries of the same type.
Note, that this adds more overhead to the message and should only really be considered, when there are
more than one resource records of the same type, class, and TTL in the message.<a href="#section-3.2.1-8" class="pilcrow">¶</a></p>
<span id="name-dns-standard-resource-recor"></span><div id="fig_dns-standard-rr">
<figure id="figure-4">
            <div class="lang-cddl sourcecode" id="section-3.2.1-9.1">
<pre>
max-uint8 = 0..255
max-uint16 = 0..65535
max-uint32 = 0..4294967295
ttl = max-uint32
ipv4-addr = bstr .size 4
ipv6-addr = bstr .size 16
$ip-addr = ipv4-addr / ipv6-addr

rr = [
  ? domain-name,
  ttl: ttl,
  type-spec-rdata,
]
type-spec-rdata = (
  ? type-spec,
  rdata: bstr // ( $ip-addr ) // ( domain-name ) // ( rdata-set ),
)
rdata-set = ((
  is-rrset: true,
  rdata-set: [ +bstr ]
) // (
  is-rrset: true,
  rdata-set: [ +[ domain-name ] ],
))
type-spec-rdata //= ( $$structured-ts-rd )
type-spec = (
  record-type: max-uint16,
  ? record-class: max-uint16,
)
</pre>
</div>
<figcaption><a href="#figure-4" class="selfRef">Figure 4</a>:
<a href="#name-dns-standard-resource-recor" class="selfRef">DNS Standard Resource Record Definition</a>
            </figcaption></figure>
</div>
<div id="soa-record-data">
<section id="section-3.2.1.1">
            <h5 id="name-soa-record-data">
<a href="#section-3.2.1.1" class="section-number selfRef">3.2.1.1. </a><a href="#name-soa-record-data" class="section-name selfRef">SOA Record Data</a>
            </h5>
<p id="section-3.2.1.1-1">The record data of RRs with <code>record-type</code> = 6 (SOA) <span class="bcp14">MAY</span> be expressed as an array with at least 7 entries representing the 7 parts of the SOA resource record defined in <span>[<a href="#RFC1035" class="cite xref">RFC1035</a>]</span> in the following order:<a href="#section-3.2.1.1-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.2.1.1-2.1">
                <p id="section-3.2.1.1-2.1.1">MNAME as a domain name (see <a href="#sec_domain-names" class="auto internal xref">Section 3.1</a>),<a href="#section-3.2.1.1-2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-3.2.1.1-2.2">
                <p id="section-3.2.1.1-2.2.1">SERIAL as an unsigned integer,<a href="#section-3.2.1.1-2.2.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-3.2.1.1-2.3">
                <p id="section-3.2.1.1-2.3.1">REFRESH as an unsigned integer,<a href="#section-3.2.1.1-2.3.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-3.2.1.1-2.4">
                <p id="section-3.2.1.1-2.4.1">RETRY as an unsigned integer,<a href="#section-3.2.1.1-2.4.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-3.2.1.1-2.5">
                <p id="section-3.2.1.1-2.5.1">EXPIRE as an unsigned integer,<a href="#section-3.2.1.1-2.5.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-3.2.1.1-2.6">
                <p id="section-3.2.1.1-2.6.1">MINIMUM as an unsigned integer, and<a href="#section-3.2.1.1-2.6.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-3.2.1.1-2.7">
                <p id="section-3.2.1.1-2.7.1">RNAME as a domain name (see <a href="#sec_domain-names" class="auto internal xref">Section 3.1</a>).<a href="#section-3.2.1.1-2.7.1" class="pilcrow">¶</a></p>
</li>
            </ul>
<p id="section-3.2.1.1-3">MNAME and RNAME are put to the beginning and end of the array, respectively, to keep their labels apart.<a href="#section-3.2.1.1-3" class="pilcrow">¶</a></p>
<p id="section-3.2.1.1-4">The definition for SOA record data can be seen in <a href="#fig_dns-rdata-soa" class="auto internal xref">Figure 5</a>.<a href="#section-3.2.1.1-4" class="pilcrow">¶</a></p>
<span id="name-soa-resource-record-data-de"></span><div id="fig_dns-rdata-soa">
<figure id="figure-5">
              <div class="lang-cddl sourcecode" id="section-3.2.1.1-5.1">
<pre>
$$structured-ts-rd //= (
  6,    ; record-type = SOA
  ? 1,  ; record-class = IN
  ( soa // ( is-rrset: true, rdata-set: [ +soa ] ) ),
)

soa = [
  domain-name,  ; mname
  serial: max-uint32,
  refresh: max-uint32,
  retry: max-uint32,
  expire: max-uint32,
  minimum: max-uint32,
  domain-name,  ; rname
]
</pre>
</div>
<figcaption><a href="#figure-5" class="selfRef">Figure 5</a>:
<a href="#name-soa-resource-record-data-de" class="selfRef">SOA Resource Record Data Definition</a>
              </figcaption></figure>
</div>
</section>
</div>
<div id="mx-record-data">
<section id="section-3.2.1.2">
            <h5 id="name-mx-record-data">
<a href="#section-3.2.1.2" class="section-number selfRef">3.2.1.2. </a><a href="#name-mx-record-data" class="section-name selfRef">MX Record Data</a>
            </h5>
<p id="section-3.2.1.2-1">The record data of RRs with <code>record-type</code> = 15 (MX) <span class="bcp14">MAY</span> be expressed as an array with at least 2 entries representing the 2 parts of the MX resource record defined in <span>[<a href="#RFC1035" class="cite xref">RFC1035</a>]</span> in the following order:<a href="#section-3.2.1.2-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.2.1.2-2.1">
                <p id="section-3.2.1.2-2.1.1">PREFERENCE as an unsigned integer and<a href="#section-3.2.1.2-2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-3.2.1.2-2.2">
                <p id="section-3.2.1.2-2.2.1">EXCHANGE as a domain name (see <a href="#sec_domain-names" class="auto internal xref">Section 3.1</a>).<a href="#section-3.2.1.2-2.2.1" class="pilcrow">¶</a></p>
</li>
            </ul>
<p id="section-3.2.1.2-3">The definition for MX record data can be seen in <a href="#fig_dns-rdata-mx" class="auto internal xref">Figure 6</a>.<a href="#section-3.2.1.2-3" class="pilcrow">¶</a></p>
<span id="name-mx-resource-record-data-def"></span><div id="fig_dns-rdata-mx">
<figure id="figure-6">
              <div class="lang-cddl sourcecode" id="section-3.2.1.2-4.1">
<pre>
$$structured-ts-rd //= (
  15,   ; record-type = MX
  ? 1,  ; record-class = IN
  ( mx // ( is-rrset: true, rdata-set: [ +mx ] ) ),
)

mx = [
  preference: max-uint16,
  domain-name,  ; exchange
]
</pre>
</div>
<figcaption><a href="#figure-6" class="selfRef">Figure 6</a>:
<a href="#name-mx-resource-record-data-def" class="selfRef">MX Resource Record Data Definition</a>
              </figcaption></figure>
</div>
</section>
</div>
<div id="srv-record-data">
<section id="section-3.2.1.3">
            <h5 id="name-srv-record-data">
<a href="#section-3.2.1.3" class="section-number selfRef">3.2.1.3. </a><a href="#name-srv-record-data" class="section-name selfRef">SRV Record Data</a>
            </h5>
<p id="section-3.2.1.3-1">The record data of RRs with <code>record-type</code> = 33 (SRV) <span class="bcp14">MAY</span> be expressed as an array with at least 3 entries representing the parts of the SRV resource record defined in <span>[<a href="#RFC2782" class="cite xref">RFC2782</a>]</span> in the following order:<a href="#section-3.2.1.3-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.2.1.3-2.1">
                <p id="section-3.2.1.3-2.1.1">Priority as an unsigned integer,<a href="#section-3.2.1.3-2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-3.2.1.3-2.2">
                <p id="section-3.2.1.3-2.2.1">an optional Weight as an unsigned integer,<a href="#section-3.2.1.3-2.2.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-3.2.1.3-2.3">
                <p id="section-3.2.1.3-2.3.1">Port as an unsigned integer,<a href="#section-3.2.1.3-2.3.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-3.2.1.3-2.4">
                <p id="section-3.2.1.3-2.4.1">Target as a domain name (see <a href="#sec_domain-names" class="auto internal xref">Section 3.1</a>).<a href="#section-3.2.1.3-2.4.1" class="pilcrow">¶</a></p>
</li>
            </ul>
<p id="section-3.2.1.3-3">If the weight is present or not can be determined by the number of unsigned integers before Target.
2 unsigned integers before the Target mean the weight was elided and defaults to 0.
3 unsigned integers before the Target mean the weight is in the second position of the record data array.
The default of 0 was picked, as this is the value domain administrators should pick when there is no server selection to do <span>[<a href="#RFC2782" class="cite xref">RFC2782</a>]</span>.<a href="#section-3.2.1.3-3" class="pilcrow">¶</a></p>
<p id="section-3.2.1.3-4">The definition for SRV record data can be seen in <a href="#fig_dns-rdata-srv" class="auto internal xref">Figure 7</a>.<a href="#section-3.2.1.3-4" class="pilcrow">¶</a></p>
<span id="name-srv-resource-record-data-de"></span><div id="fig_dns-rdata-srv">
<figure id="figure-7">
              <div class="lang-cddl sourcecode" id="section-3.2.1.3-5.1">
<pre>
$$structured-ts-rd //= (
  33,   ; record-type = SRV
  ? 1,  ; record-class = IN
  ( srv // ( is-rrset: true, rdata-set: [ +srv ] ) ),
)

srv = [
  priority: max-uint16,
  ? weight: max-uint16 .default 0,
  port: max-uint16,
  domain-name,  ; target
]
</pre>
</div>
<figcaption><a href="#figure-7" class="selfRef">Figure 7</a>:
<a href="#name-srv-resource-record-data-de" class="selfRef">SRV Resource Record Data Definition</a>
              </figcaption></figure>
</div>
</section>
</div>
<div id="svcb-and-https-record-data">
<section id="section-3.2.1.4">
            <h5 id="name-svcb-and-https-record-data">
<a href="#section-3.2.1.4" class="section-number selfRef">3.2.1.4. </a><a href="#name-svcb-and-https-record-data" class="section-name selfRef">SVCB and HTTPS Record Data</a>
            </h5>
<p id="section-3.2.1.4-1">The record data of RRs with <code>record-type</code> = 64 (SVCB) and <code>record-type</code> = 65 (HTTPS) <span class="bcp14">MAY</span> be expressed as an array with at least 3 entries representing the 3 parts of the SVCB/HTTPS resource record defined in <span>[<a href="#RFC9460" class="cite xref">RFC9460</a>]</span> in the following order:<a href="#section-3.2.1.4-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.2.1.4-2.1">
                <p id="section-3.2.1.4-2.1.1">An optional SvcPriority as an unsigned integer,<a href="#section-3.2.1.4-2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-3.2.1.4-2.2">
                <p id="section-3.2.1.4-2.2.1">An optional TargetName as a domain name (see <a href="#sec_domain-names" class="auto internal xref">Section 3.1</a>), and<a href="#section-3.2.1.4-2.2.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-3.2.1.4-2.3">
                <p id="section-3.2.1.4-2.3.1">SvcParams as an array of alternating pairs of SvcParamKey (as unsigned integer) and SvcParamValue
(as byte string).
The type of SvcParamValue may be extended in future specifications.<a href="#section-3.2.1.4-2.3.1" class="pilcrow">¶</a></p>
</li>
            </ul>
<p id="section-3.2.1.4-3">If the SvcPriority is present can be determined by checking if the record data array starts with an unsigned integer or not.
If the array does not start with an unsigned integer, the SvcPriority is elided and defaults to 0, i.e., the record is in AliasMode (see <span><a href="https://rfc-editor.org/rfc/rfc9460#section-2.4.2" class="relref">Section 2.4.2</a> of [<a href="#RFC9460" class="cite xref">RFC9460</a>]</span>).
If the array starts with a unsigned integer, it is the SvcPriority.<a href="#section-3.2.1.4-3" class="pilcrow">¶</a></p>
<p id="section-3.2.1.4-4">If the TargetName is present can be determined by checking if the record data array has a domain name after the SvcPriority, i.e., if the SvcPriority is elided the array would start with a domain name.
If there is no domain name after the SvcPriority, the TargetName is elided and defaults to the sequence of text strings <code>""</code> (i.e., the root domain "." in the common name representation defined in <span><a href="https://rfc-editor.org/rfc/rfc1035#section-2.3.1" class="relref">Section 2.3.1</a> of [<a href="#RFC1035" class="cite xref">RFC1035</a>]</span>, see <a href="#sec_domain-names" class="auto internal xref">Section 3.1</a>) and <span><a href="https://rfc-editor.org/rfc/rfc9460#section-2.5" class="relref">Section 2.5</a> of [<a href="#RFC9460" class="cite xref">RFC9460</a>]</span>.
If there is a domain name after the SvcPriority, the TargetName is not elided and in the domain name form specified in <a href="#sec_domain-names" class="auto internal xref">Section 3.1</a>.<a href="#section-3.2.1.4-4" class="pilcrow">¶</a></p>
<p id="section-3.2.1.4-5">The definition for SVCB and HTTPS record data can be seen in <a href="#fig_dns-rdata-svcb" class="auto internal xref">Figure 8</a>.<a href="#section-3.2.1.4-5" class="pilcrow">¶</a></p>
<span id="name-svcb-and-https-resource-rec"></span><div id="fig_dns-rdata-svcb">
<figure id="figure-8">
              <div class="lang-cddl sourcecode" id="section-3.2.1.4-6.1">
<pre>
$$structured-ts-rd //= (
  64 / 65,  ; record-type = SVCB or HTTPS
  ? 1,      ; record-class = IN
  ( svcb // ( is-rrset: true, rdata-set: [ +svcb ] ) ),
)

svcb = [
  ? svc-priority: max-uint16 .default 0,
  ? domain-name,  ; target name
  svc-params: [ *svc-param-pair ],
]

svc-param-pair = (
  svc-param-key: max-uint16,
  svc-param-value: $$svc-param-value,
)
$$svc-param-value = bstr / $ip-addr
</pre>
</div>
<figcaption><a href="#figure-8" class="selfRef">Figure 8</a>:
<a href="#name-svcb-and-https-resource-rec" class="selfRef">SVCB and HTTPS Resource Record Data Definition</a>
              </figcaption></figure>
</div>
<p id="section-3.2.1.4-7">The SvcParams are provided as an array rather than a map, as their order needs to be preserved <span>[<a href="#RFC9460" class="cite xref">RFC9460</a>]</span> which can not be guaranteed for maps.<a href="#section-3.2.1.4-7" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="sec_edns">
<section id="section-3.2.2">
          <h4 id="name-edns-opt-pseudo-rrs">
<a href="#section-3.2.2" class="section-number selfRef">3.2.2. </a><a href="#name-edns-opt-pseudo-rrs" class="section-name selfRef">EDNS OPT Pseudo-RRs</a>
          </h4>
<p id="section-3.2.2-1">EDNS OPT Pseudo-RRs are represented as a CBOR array.
To distinguish them from normal standard RRs, they are marked with tag TBD141.<a href="#section-3.2.2-1" class="pilcrow">¶</a></p>
<p id="section-3.2.2-2">Name and record type can be elided as they are always "." and OPT (41), respectively <span>[<a href="#RFC6891" class="cite xref">RFC6891</a>]</span>.<a href="#section-3.2.2-2" class="pilcrow">¶</a></p>
<p id="section-3.2.2-3">The UDP payload size may be the first element as an unsigned integer in the array.
It <span class="bcp14">MUST</span> be elided if its value is the default value of 512, the maximum allowable size for unextended DNS over UDP (see Sections <a href="https://rfc-editor.org/rfc/rfc1035#section-2.3.4" class="relref">2.3.4</a> and <a href="https://rfc-editor.org/rfc/rfc1035#section-4.2.1" class="relref">4.2.1</a> of <span>[<a href="#RFC1035" class="cite xref">RFC1035</a>]</span>).<a href="#section-3.2.2-3" class="pilcrow">¶</a></p>
<p id="section-3.2.2-4">The next element is an array of the options as alternating pairs of option code (as unsigned integer) and option data (as byte string).
The type of the option data may be extended in future specifications.
As per <span><a href="https://rfc-editor.org/rfc/rfc6891#section-6.1.2" class="relref">Section 6.1.2</a> of [<a href="#RFC6891" class="cite xref">RFC6891</a>]</span>, the order of options is not defined in this specification, but the considerations to order provided in <span><a href="https://rfc-editor.org/rfc/rfc6891#section-6.1.2" class="relref">Section 6.1.2</a> of [<a href="#RFC6891" class="cite xref">RFC6891</a>]</span> also apply here.<a href="#section-3.2.2-4" class="pilcrow">¶</a></p>
<p id="section-3.2.2-5">After that, up to three unsigned integers are following.
The first being the extended flags as unsigned integer (implied to be 0 if elided),
the second the extended RCODE as an unsigned integer (implied to be 0 if elided), and
the third the EDNS version (implied to be 0 if elided).
They are dependent on each of their previous elements.
If the EDNS version is not elided, both extended flags and extended RCODE <span class="bcp14">MUST</span> not be elided.
If the RCODE is not elided the extended flags <span class="bcp14">MUST</span> not be elided.<a href="#section-3.2.2-5" class="pilcrow">¶</a></p>
<p id="section-3.2.2-6">Note that future EDNS versions may require a different format than the one described above.<a href="#section-3.2.2-6" class="pilcrow">¶</a></p>
<span id="name-dns-opt-resource-record-def"></span><div id="fig_dns-opt-rr">
<figure id="figure-9">
            <div class="lang-cddl sourcecode" id="section-3.2.2-7.1">
<pre>
opt-rr = [
  ? udp-payload-size: max-uint16 .default 512,
  options: [* opt-pair ],
  ? opt-rcode-v-flags,
]
opt-pair = (
  ocode: max-uint16,
  odata: $$odata,
)
opt-rcode-v-flags = (
  flags: max-uint16 .default 0,
  ? opt-rcode-v,
)
rcode = 0..4095
opt-rcode-v = (
  rcode: rcode .default 0,
  ? version: max-uint8 .default 0,
)
$$odata = bstr
</pre>
</div>
<figcaption><a href="#figure-9" class="selfRef">Figure 9</a>:
<a href="#name-dns-opt-resource-record-def" class="selfRef">DNS OPT Resource Record Definition</a>
            </figcaption></figure>
</div>
</section>
</div>
</section>
</div>
<div id="sec_queries">
<section id="section-3.3">
        <h3 id="name-dns-queries">
<a href="#section-3.3" class="section-number selfRef">3.3. </a><a href="#name-dns-queries" class="section-name selfRef">DNS Queries</a>
        </h3>
<p id="section-3.3-1">DNS queries are encoded as CBOR arrays containing up to 6 entries in the following order:<a href="#section-3.3-1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-3.3-2">
<li id="section-3.3-2.1">
            <p id="section-3.3-2.1.1">An optional boolean field,<a href="#section-3.3-2.1.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-3.3-2.2">
            <p id="section-3.3-2.2.1">An optional flag field (as unsigned integer),<a href="#section-3.3-2.2.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-3.3-2.3">
            <p id="section-3.3-2.3.1">The question section (as array),<a href="#section-3.3-2.3.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-3.3-2.4">
            <p id="section-3.3-2.4.1">An optional answer section (as array),<a href="#section-3.3-2.4.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-3.3-2.5">
            <p id="section-3.3-2.5.1">An optional authority section (as array), and<a href="#section-3.3-2.5.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-3.3-2.6">
            <p id="section-3.3-2.6.1">An optional additional section (as array)<a href="#section-3.3-2.6.1" class="pilcrow">¶</a></p>
</li>
        </ol>
<p id="section-3.3-3">If the first item is a boolean and when true, it tells the responding resolver that it <span class="bcp14">MUST</span> include the question section in its response. If that boolean is not present, it is assumed to be false.<a href="#section-3.3-3" class="pilcrow">¶</a></p>
<p id="section-3.3-4">If the first item of the query is an array, it is the question section, if it is an unsigned integer, it is as flag field and maps to the header flags in <span>[<a href="#RFC1035" class="cite xref">RFC1035</a>]</span> and the "DNS Header Flags" IANA registry including the QR flag and the Opcode.<a href="#section-3.3-4" class="pilcrow">¶</a></p>
<p id="section-3.3-5">If the flags are elided, the value 0 is assumed.<a href="#section-3.3-5" class="pilcrow">¶</a></p>
<p id="section-3.3-6">This specification assumes that the DNS messages are sent over a transfer protocol that can map the queries to their responses, e.g., DNS over HTTPS <span>[<a href="#RFC8484" class="cite xref">RFC8484</a>]</span> or DNS over CoAP <span>[<a href="#I-D.ietf-core-dns-over-coap" class="cite xref">I-D.ietf-core-dns-over-coap</a>]</span>.
As a consequence, the DNS transaction ID is always elided and the value 0 is assumed.<a href="#section-3.3-6" class="pilcrow">¶</a></p>
<p id="section-3.3-7">A question record within the question section is encoded as a CBOR array containing the following entries:<a href="#section-3.3-7" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-3.3-8">
<li id="section-3.3-8.1">
            <p id="section-3.3-8.1.1">The queried name (as domain name, see <a href="#sec_domain-names" class="auto internal xref">Section 3.1</a>) which <span class="bcp14">MUST</span> not be elided,<a href="#section-3.3-8.1.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-3.3-8.2">
            <p id="section-3.3-8.2.1">An optional record type (as unsigned integer), and<a href="#section-3.3-8.2.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-3.3-8.3">
            <p id="section-3.3-8.3.1">An optional record class (as unsigned integer)<a href="#section-3.3-8.3.1" class="pilcrow">¶</a></p>
</li>
        </ol>
<p id="section-3.3-9">If the record type is elided, record type <code>AAAA</code> as specified in <span>[<a href="#RFC3596" class="cite xref">RFC3596</a>]</span> is assumed.
If the record class is elided, record class <code>IN</code> as specified in <span>[<a href="#RFC1035" class="cite xref">RFC1035</a>]</span> is assumed.
When a record class is required, the record type <span class="bcp14">MUST</span> also be provided.<a href="#section-3.3-9" class="pilcrow">¶</a></p>
<p id="section-3.3-10">There usually is only one question record <span>[<a href="#RFC9619" class="cite xref">RFC9619</a>]</span>, which is why the question section is a flat array and not nested like the other sections.
This serves to safe overhead from the additional CBOR array header.
In the rare cases when there is more than one question record in the question section, the next question just follows.
In this case, for every question but the last, the record type <span class="bcp14">MUST</span> be included, i.e., it is not optional.
This way it is ensured that the parser can distinguish each question by looking up the name first.<a href="#section-3.3-10" class="pilcrow">¶</a></p>
<p id="section-3.3-11">The remainder of the query is either empty or <span class="bcp14">MUST</span> consist of up to three extra arrays.<a href="#section-3.3-11" class="pilcrow">¶</a></p>
<p id="section-3.3-12">If one extra array is in the query, it encodes the additional section of the query as an array of DNS resource records (see <a href="#sec_rr" class="auto internal xref">Section 3.2</a>).
If two extra arrays are in the query, they encode, in that order, the authority and additional sections of the query each as an array of DNS resource records (see <a href="#sec_rr" class="auto internal xref">Section 3.2</a>).
If three extra arrays are in the query, they encode, in that order, the answer section, the authority, and additional sections of the query each as an array of DNS resource records (see <a href="#sec_rr" class="auto internal xref">Section 3.2</a>).<a href="#section-3.3-12" class="pilcrow">¶</a></p>
<p id="section-3.3-13">As such, the highest precedence in elision is given to the answer section, as it only occurs with mDNS to signify Known Answers <span>[<a href="#RFC6762" class="cite xref">RFC6762</a>]</span>.
The lowest precedence is given to the additional section, as it may contain EDNS OPT Pseudo-RRs, which are common in queries (see <a href="#sec_edns" class="auto internal xref">Section 3.2.2</a>).<a href="#section-3.3-13" class="pilcrow">¶</a></p>
<p id="section-3.3-14">The representation of a DNS query is defined in <a href="#fig_dns-query" class="auto internal xref">Figure 10</a>.<a href="#section-3.3-14" class="pilcrow">¶</a></p>
<span id="name-dns-query-definition"></span><div id="fig_dns-query">
<figure id="figure-10">
          <div class="lang-cddl sourcecode" id="section-3.3-15.1">
<pre>
dns-query = [
  ? incl-question: bool .default false,
  ? flags: max-uint16 .default 0x0000,
  question-section,
  ? query-extra-sections,
]
question-section = [
  * full-question,
  ? last-question,
]
full-question = (
  domain-name,
  type-spec,
)
last-question = (
  domain-name,
  ? type-spec,
)
query-extra-sections = (
  ? answer-section,
  extra-sections,
)
answer-section = [+ $$dns-rr]
extra-sections = (
  ? authority: [+ $$dns-rr],
  additional: [+ $$dns-rr],
)
</pre>
</div>
<figcaption><a href="#figure-10" class="selfRef">Figure 10</a>:
<a href="#name-dns-query-definition" class="selfRef">DNS Query Definition</a>
          </figcaption></figure>
</div>
</section>
</div>
<div id="sec_responses">
<section id="section-3.4">
        <h3 id="name-dns-responses">
<a href="#section-3.4" class="section-number selfRef">3.4. </a><a href="#name-dns-responses" class="section-name selfRef">DNS Responses</a>
        </h3>
<p id="section-3.4-1">A DNS response is encoded as a CBOR array containing up to 5 entries.<a href="#section-3.4-1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-3.4-2">
<li id="section-3.4-2.1">
            <p id="section-3.4-2.1.1">An optional flag field (as unsigned integer),<a href="#section-3.4-2.1.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-3.4-2.2">
            <p id="section-3.4-2.2.1">An optional question section (as array, encoded as described in <a href="#sec_queries" class="auto internal xref">Section 3.3</a>)<a href="#section-3.4-2.2.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-3.4-2.3">
            <p id="section-3.4-2.3.1">The answer section (as array),<a href="#section-3.4-2.3.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-3.4-2.4">
            <p id="section-3.4-2.4.1">An optional authority section (as array), and<a href="#section-3.4-2.4.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-3.4-2.5">
            <p id="section-3.4-2.5.1">An optional additional section (as array)<a href="#section-3.4-2.5.1" class="pilcrow">¶</a></p>
</li>
        </ol>
<p id="section-3.4-3">As for queries, the DNS transaction ID is elided and implied to be 0.<a href="#section-3.4-3" class="pilcrow">¶</a></p>
<p id="section-3.4-4">If the CBOR array is a response to a query for which the flags indicate that flags are set in the
response, they <span class="bcp14">MUST</span> be set accordingly and thus included in the response.
If the flags are not included, the flags are implied to be 0x8000 (everything unset except for the
QR flag).<a href="#section-3.4-4" class="pilcrow">¶</a></p>
<p id="section-3.4-5">If the response includes only one array, then the DNS answer section represents an
array of one or more DNS Resource Records (see <a href="#sec_rr" class="auto internal xref">Section 3.2</a>).<a href="#section-3.4-5" class="pilcrow">¶</a></p>
<p id="section-3.4-6">If the response includes more than 2 arrays, the first entry may be the question section, identified
by not being an array of arrays. It <span class="bcp14">MUST</span> be included, if the client requested it using the boolean
field in the query. If it is present, it is followed by the answer section. The question section is
encoded as specified in <a href="#sec_queries" class="auto internal xref">Section 3.3</a>.<a href="#section-3.4-6" class="pilcrow">¶</a></p>
<p id="section-3.4-7">If the answer section is followed by one extra array, this array is the additional section.
Like the answer section, the additional section is represented as an array of one or more DNS Resource Records (see <a href="#sec_rr" class="auto internal xref">Section 3.2</a>).<a href="#section-3.4-7" class="pilcrow">¶</a></p>
<p id="section-3.4-8">If the answer section is followed by two extra arrays, the first is the authority section, and the second is the additional section.
The authority section is also represented as an array of one or more DNS Resource Records (see
<a href="#sec_rr" class="auto internal xref">Section 3.2</a>).<a href="#section-3.4-8" class="pilcrow">¶</a></p>
<p id="section-3.4-9">The authority section is given precedence in elision over the additional section, as due to EDNS options or, e.g., CNAME answers that also provide the A/AAAA records. The additional section tends to show up more often than the authority section.<a href="#section-3.4-9" class="pilcrow">¶</a></p>
<span id="name-dns-response-definition"></span><div id="fig_dns-response">
<figure id="figure-11">
          <div class="lang-cddl sourcecode" id="section-3.4-10.1">
<pre>
dns-response = [
  ? flags: max-uint16 .default 0x8000,
  ? question-section,
  answer-section,
  ? extra-sections,
]
</pre>
</div>
<figcaption><a href="#figure-11" class="selfRef">Figure 11</a>:
<a href="#name-dns-response-definition" class="selfRef">DNS Response Definition</a>
          </figcaption></figure>
</div>
</section>
</div>
</section>
</div>
<div id="sec_cbor-packed">
<section id="section-4">
      <h2 id="name-compression-with-packed-cbo">
<a href="#section-4" class="section-number selfRef">4. </a><a href="#name-compression-with-packed-cbo" class="section-name selfRef">Compression with Packed CBOR</a>
      </h2>
<p id="section-4-1">Packed CBOR <span>[<a href="#I-D.ietf-cbor-packed" class="cite xref">I-D.ietf-cbor-packed</a>]</span> is used for name compression in "application/dns+cbor".<a href="#section-4-1" class="pilcrow">¶</a></p>
<p id="section-4-2">If both DNS server and client support table setup tag 113 as described in <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-cbor-packed-19#section-3.1" class="relref">Section 3.1</a> of [<a href="#I-D.ietf-cbor-packed" class="cite xref">I-D.ietf-cbor-packed</a>]</span>, it <span class="bcp14">MAY</span> be used for further
compression in DNS responses.
Especially IPv6 addresses, e.g., in AAAA resource records can benefit from straight referencing to
compress common address prefixes.<a href="#section-4-2" class="pilcrow">¶</a></p>
<div id="sec_name-compression">
<section id="section-4.1">
        <h3 id="name-name-compression">
<a href="#section-4.1" class="section-number selfRef">4.1. </a><a href="#name-name-compression" class="section-name selfRef">Name Compression</a>
        </h3>
<span id="name-cddl-for-name-compression-b"></span><div id="fig_name-compression-cddl">
<figure id="figure-12">
          <div class="lang-cddl sourcecode" id="section-4.1-1.1">
<pre>
Text-String-Suffix-Sequence-Packed-CBOR = #6.28259(rump)
</pre>
</div>
<figcaption><a href="#figure-12" class="selfRef">Figure 12</a>:
<a href="#name-cddl-for-name-compression-b" class="selfRef">CDDL for name compression based on Packed CBOR and as defined in this document.</a>
          </figcaption></figure>
</div>
<p id="section-4.1-2">For name compression, a new packing table setup tag TBD28259 ('n' and 'c' in ASCII) for Packed CBOR <span>[<a href="#I-D.ietf-cbor-packed" class="cite xref">I-D.ietf-cbor-packed</a>]</span> is defined.
Any "application/dns+cbor" encoder and decoder <span class="bcp14">MUST</span> support tag TBD28259 for DNS queries and responses.
It provides an implicit text string suffix sequence table for shared items <em>V</em>.
This table <em>V</em> is appended to the existing table for shared items of any table setup tag enclosing tag TBD28259 (by default empty table).
This implicit (i.e., not explicitly represented) table <em>V</em> is constructed as follows:
Any coherent sequence of text strings encountered within the rump of tag TBD28259 when reading it depth-first, as well as any of its non-empty suffixes, ordered by their appearance within the rump, are added to the table as arrays marked with the splice integration tag 1115 (see <span>[<a href="#I-D.ietf-cbor-packed" class="cite xref">I-D.ietf-cbor-packed</a>], <a href="https://datatracker.ietf.org/doc/html/draft-ietf-cbor-packed-19#section-5.1" class="relref">Section 5.1</a></span>).
If a sequence for which a tagged array is already in <em>V</em> is encountered, a shared item reference <em>i</em> is added to the rump instead, splicing the content of the array within tag 1115 into the existing array (see <span>[<a href="#I-D.ietf-cbor-packed" class="cite xref">I-D.ietf-cbor-packed</a>], <a href="https://datatracker.ietf.org/doc/html/draft-ietf-cbor-packed-19#section-5.1" class="relref">Section 5.1</a></span>) and that sequence as well as its non-empty suffixes are not added again to <em>V</em>.
The resulting rump should look like referencing the first instance of the <em>i</em>-th complete string sequence (depth first) in the sequence.<a href="#section-4.1-2" class="pilcrow">¶</a></p>
<p id="section-4.1-3">It is <span class="bcp14">NOT RECOMMENDED</span> to use any other table building tag as defined in <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-cbor-packed-19#section-3" class="relref">Section 3</a> of [<a href="#I-D.ietf-cbor-packed" class="cite xref">I-D.ietf-cbor-packed</a>]</span> within TBD28259, as the implicit table of TBD28259 may otherwise lead to more complicating en- and decoding steps.
Particularly, a one-pass decoding with minimal state of DNS messages <span class="bcp14">SHOULD</span> be ensured to be viable on constrained devices.
If another table setup needs to be transported within TBD28259, e.g., certain RDATA or option values might elect to use Packed CBOR as well, they <span class="bcp14">SHOULD</span> be encapsulated as encoded CBOR within a byte string using tag 24 <span>[<a href="#RFC8949" class="cite xref">RFC8949</a>]</span>.<a href="#section-4.1-3" class="pilcrow">¶</a></p>
<p id="section-4.1-4">Due to the order of strings being important, special care should be taken for the order of map (major type 5, <span>[<a href="#RFC8949" class="cite xref">RFC8949</a>]</span>) elements within tag TBD28259.
The "application/dns+cbor" media type specified within this document avoids maps for this reason, in addition to enforcing orders derived from DNS specifications, e.g., <span>[<a href="#RFC9460" class="cite xref">RFC9460</a>]</span> for SvcParams.
If any other CBOR object than an object defined by <code>dns-message</code> in <a href="#fig_dns-msg" class="auto internal xref">Figure 1</a> is compressed using TBD28259, map elements <span class="bcp14">MUST</span> be encoded in bytewise lexicographic order of their keys, as specified in <span><a href="https://rfc-editor.org/rfc/rfc8949#section-4.2.1" class="relref">Section 4.2.1</a> of [<a href="#RFC8949" class="cite xref">RFC8949</a>]</span>, unless the definition of that particular object type provides a different predetermined order.<a href="#section-4.1-4" class="pilcrow">¶</a></p>
<p id="section-4.1-5">The "application/dns+cbor" media type comes with an optional parameter "packed".
If it is not provided, the value of it is assumed to be 0.
With the "application/dns+cbor;packed=0" media type (i.e., even with "application/dns+cbor"), the tag TBD28259 is implicit, i.e., it <span class="bcp14">SHOULD NOT</span> be sent.
This avoids sending the 3 bytes of overhead generated by the presence of the tag.
If the decoder encounters an object marked with "application/dns+cbor;packed=0" that is tagged TBD28259, it <span class="bcp14">MUST NOT</span> discard it and parse its content as if it were implicit.
Otherwise, it might incur an additional message to be sent and media type negotiation might fail unnecessarily.<a href="#section-4.1-5" class="pilcrow">¶</a></p>
<p id="section-4.1-6">The splice integration tag 1115 is the only integration tag in use for "application/dns+cbor" for "packed=0" and "packed=1" (see <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-cbor-packed-19#section-5" class="relref">Section 5</a> of [<a href="#I-D.ietf-cbor-packed" class="cite xref">I-D.ietf-cbor-packed</a>]</span>).<a href="#section-4.1-6" class="pilcrow">¶</a></p>
<p id="section-4.1-7">Name compression with an example message can be found in <a href="#sec_name-compression-example" class="auto internal xref">Section 8.3</a>.<a href="#section-4.1-7" class="pilcrow">¶</a></p>
</section>
</div>
<div id="further-dns-representation-with-tag-113">
<section id="section-4.2">
        <h3 id="name-further-dns-representation-">
<a href="#section-4.2" class="section-number selfRef">4.2. </a><a href="#name-further-dns-representation-" class="section-name selfRef">Further DNS Representation with Tag 113</a>
        </h3>
<p id="section-4.2-1">The representation of DNS responses with packed value 1, i.e., "application/dns+cbor;packed=1", has the same semantics as for tag TBD113
(see <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-cbor-packed-19#section-3.1" class="relref">Section 3.1</a> of [<a href="#I-D.ietf-cbor-packed" class="cite xref">I-D.ietf-cbor-packed</a>]</span>) compressing the name-compressed response as rump.
The difference to <span>[<a href="#I-D.ietf-cbor-packed" class="cite xref">I-D.ietf-cbor-packed</a>]</span> is that tag TBD113 is implicit with media type parameter "packed=1", see <a href="#fig_packed-dns-msg" class="auto internal xref">Figure 13</a>.<a href="#section-4.2-1" class="pilcrow">¶</a></p>
<p id="section-4.2-2">Take the following definition:<a href="#section-4.2-2" class="pilcrow">¶</a></p>
<span id="name-definition-of-packed-dns-me"></span><div id="fig_packed-dns-msg">
<figure id="figure-13">
          <div class="lang-cddl sourcecode" id="section-4.2-3.1">
<pre>
packed-dns-message = [
  [*shared-and-argument-item],
  rump
]
</pre>
</div>
<figcaption><a href="#figure-13" class="selfRef">Figure 13</a>:
<a href="#name-definition-of-packed-dns-me" class="selfRef">Definition of packed DNS message with media type "application/dns+cbor;packed=1".</a>
          </figcaption></figure>
</div>
<p id="section-4.2-4">When marked by the "application/dns+cbor;packed=1" media type and parameter it <span class="bcp14">MUST</span> be implicitly understood as the definition provided in <a href="#fig_expl-packed-dns-msg" class="auto internal xref">Figure 14</a>.<a href="#section-4.2-4" class="pilcrow">¶</a></p>
<span id="name-the-implicit-definition-of-"></span><div id="fig_expl-packed-dns-msg">
<figure id="figure-14">
          <div class="lang-cddl sourcecode" id="section-4.2-5.1">
<pre>
Packed-Text-String-Suffix-Sequence-Packed-CBOR = #6.113(
  [
    [*shared-and-argument-item],
    Text-String-Suffix-Sequence-Packed-CBOR
  ]
)
</pre>
</div>
<figcaption><a href="#figure-14" class="selfRef">Figure 14</a>:
<a href="#name-the-implicit-definition-of-" class="selfRef">The implicit definition of a packed DNS message with media type "application/dns+cbor;packed=1".</a>
          </figcaption></figure>
</div>
<p id="section-4.2-6">If the decoder encounters an object marked with "application/dns+cbor;packed=1" that is tagged TBD113 or with its rump tagged TBD28259, it <span class="bcp14">MUST NOT</span> discard it and parse its content as if it were implicit.
Any object marked with "application/dns+cbor;packed=1" that does not fit the definition of
<code>packed-dns-message</code> provided in <a href="#fig_packed-dns-msg" class="auto internal xref">Figure 13</a> or variants of explicit tags TBD113 or TBD28259 <span class="bcp14">MUST</span> be interpreted as an invalid message.<a href="#section-4.2-6" class="pilcrow">¶</a></p>
<p id="section-4.2-7">"packed=1" compression of queries is not specified, as apart from EDNS(0) (see <a href="#sec_edns" class="auto internal xref">Section 3.2.2</a>), they only
consist of one question most of the time, i.e., there is close to no redundancy that is not already
covered by "packed=0" and encoding such an object can be too complex for a potentially constrained resolver.<a href="#section-4.2-7" class="pilcrow">¶</a></p>
<p id="section-4.2-8">An example of this mechanism, as well as pseudo-code for a simple decoder can be found in
<a href="#sec_packed-cbor-example" class="auto internal xref">Section 8.5</a>.<a href="#section-4.2-8" class="pilcrow">¶</a></p>
</section>
</div>
<div id="media-type-negotiation">
<section id="section-4.3">
        <h3 id="name-media-type-negotiation">
<a href="#section-4.3" class="section-number selfRef">4.3. </a><a href="#name-media-type-negotiation" class="section-name selfRef">Media Type Negotiation</a>
        </h3>
<p id="section-4.3-1">A DNS client tells a server that it would accept the media type "application/dns+cbor;packed=1" to negotiate (see, e.g.,
<span>[<a href="#RFC9110" class="cite xref">RFC9110</a>]</span> or <span>[<a href="#RFC7252" class="cite xref">RFC7252</a>], <a href="https://rfc-editor.org/rfc/rfc7252#section-5.5.4" class="relref">Section 5.5.4</a></span>) with the DNS server whether the server supports setup table tag TBD113.
If it does, it <span class="bcp14">MAY</span> request the response to be in packed value 1 (media type "application/dns+cbor;packed=1").
The server then <span class="bcp14">SHOULD</span> reply with the response in Packed CBOR, which it also signals with media type
"application/dns+cbor;packed=1".
Otherwise, both fall back to the implicit "packed=0".<a href="#section-4.3-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sec_pack-compression">
<section id="section-4.4">
        <h3 id="name-compression">
<a href="#section-4.4" class="section-number selfRef">4.4. </a><a href="#name-compression" class="section-name selfRef">Compression</a>
        </h3>
<p id="section-4.4-1">The method of the compressor to construct the packing table, i.e., how the compression is applied, is out of scope of this document.<a href="#section-4.4-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="implementation-status">
<section id="section-5">
      <h2 id="name-implementation-status">
<a href="#section-5" class="section-number selfRef">5. </a><a href="#name-implementation-status" class="section-name selfRef">Implementation Status</a>
      </h2>
<p id="section-5-1">This section records the status of known implementations of the
protocol defined by this specification at the time of posting of
this Internet-Draft, and is based on a proposal described in
<span>[<a href="#RFC7942" class="cite xref">RFC7942</a>]</span>.  The description of implementations in this section is
intended to assist the IETF in its decision processes in
progressing drafts to RFCs.  Please note that the listing of any
individual implementation here does not imply endorsement by the
IETF.  Furthermore, no effort has been spent to verify the
information presented here that was supplied by IETF contributors.
This is not intended as, and must not be construed to be, a
catalog of available implementations or their features.  Readers
are advised to note that other implementations may exist.<a href="#section-5-1" class="pilcrow">¶</a></p>
<p id="section-5-2">According to <span>[<a href="#RFC7942" class="cite xref">RFC7942</a>]</span>, "this will allow reviewers and working
groups to assign due consideration to documents that have the
benefit of running code, which may serve as evidence of valuable
experimentation and feedback that have made the implemented
protocols more mature.  It is up to the individual working groups
to use this information as they see fit".<a href="#section-5-2" class="pilcrow">¶</a></p>
<div id="python-decoderencoder">
<section id="section-5.1">
        <h3 id="name-python-decoder-encoder">
<a href="#section-5.1" class="section-number selfRef">5.1. </a><a href="#name-python-decoder-encoder" class="section-name selfRef">Python decoder/encoder</a>
        </h3>
<p id="section-5.1-1">The authors of this document provide a <a href="https://github.com/netd-tud/cbor4dns">decoder/encoder
implementation</a> of both the unpacked and packed format
specified in this document in Python.<a href="#section-5.1-1" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-5.1-2">
          <dt id="section-5.1-2.1">Level of maturity:</dt>
          <dd style="margin-left: 1.5em" id="section-5.1-2.2">
            <p id="section-5.1-2.2.1">prototype<a href="#section-5.1-2.2.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-5.1-2.3">Version compatibility:</dt>
          <dd style="margin-left: 1.5em" id="section-5.1-2.4">
            <p id="section-5.1-2.4.1">draft-lenders-dns-cbor-10<a href="#section-5.1-2.4.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-5.1-2.5">License:</dt>
          <dd style="margin-left: 1.5em" id="section-5.1-2.6">
            <p id="section-5.1-2.6.1">MIT<a href="#section-5.1-2.6.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-5.1-2.7">Contact information:</dt>
          <dd style="margin-left: 1.5em" id="section-5.1-2.8">
            <p id="section-5.1-2.8.1"><code>Martine Lenders &lt;martine.lenders@tu-dresden.de&gt;</code><a href="#section-5.1-2.8.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-5.1-2.9">Last update of this information:</dt>
          <dd style="margin-left: 1.5em" id="section-5.1-2.10">
            <p id="section-5.1-2.10.1">July 2024<a href="#section-5.1-2.10.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
</dl>
</section>
</div>
<div id="embedded-decoderencoder">
<section id="section-5.2">
        <h3 id="name-embedded-decoder-encoder">
<a href="#section-5.2" class="section-number selfRef">5.2. </a><a href="#name-embedded-decoder-encoder" class="section-name selfRef">Embedded decoder/encoder</a>
        </h3>
<p id="section-5.2-1">The authors of this document provide a <a href="https://github.com/RIOT-OS/RIOT/pull/19989">decoder/encoder
implementation</a> of the unpacked format specified in this
document for the RIOT operating system. It can only encode queries and decode responses.<a href="#section-5.2-1" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-5.2-2">
          <dt id="section-5.2-2.1">Level of maturity:</dt>
          <dd style="margin-left: 1.5em" id="section-5.2-2.2">
            <p id="section-5.2-2.2.1">prototype<a href="#section-5.2-2.2.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-5.2-2.3">Version compatibility:</dt>
          <dd style="margin-left: 1.5em" id="section-5.2-2.4">
            <p id="section-5.2-2.4.1">draft-lenders-dns-cbor-08<a href="#section-5.2-2.4.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-5.2-2.5">License:</dt>
          <dd style="margin-left: 1.5em" id="section-5.2-2.6">
            <p id="section-5.2-2.6.1">MIT<a href="#section-5.2-2.6.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-5.2-2.7">Contact information:</dt>
          <dd style="margin-left: 1.5em" id="section-5.2-2.8">
            <p id="section-5.2-2.8.1"><code>Martine Lenders &lt;martine.lenders@tu-dresden.de&gt;</code><a href="#section-5.2-2.8.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-5.2-2.9">Last update of this information:</dt>
          <dd style="margin-left: 1.5em" id="section-5.2-2.10">
            <p id="section-5.2-2.10.1">October 2023<a href="#section-5.2-2.10.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
</dl>
</section>
</div>
</section>
</div>
<div id="security-considerations">
<section id="section-6">
      <h2 id="name-security-considerations">
<a href="#section-6" class="section-number selfRef">6. </a><a href="#name-security-considerations" class="section-name selfRef">Security Considerations</a>
      </h2>
<p id="section-6-1">TODO Security<a href="#section-6-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="iana-considerations">
<section id="section-7">
      <h2 id="name-iana-considerations">
<a href="#section-7" class="section-number selfRef">7. </a><a href="#name-iana-considerations" class="section-name selfRef">IANA Considerations</a>
      </h2>
<div id="media-type">
<section id="section-7.1">
        <h3 id="name-media-type-registration">
<a href="#section-7.1" class="section-number selfRef">7.1. </a><a href="#name-media-type-registration" class="section-name selfRef">Media Type Registration</a>
        </h3>
<p id="section-7.1-1">This document registers a media type for the serialization format of DNS messages in CBOR. It
follows the procedures specified in <span>[<a href="#RFC6838" class="cite xref">RFC6838</a>]</span>.<a href="#section-7.1-1" class="pilcrow">¶</a></p>
<div id="applicationdnscbor">
<section id="section-7.1.1">
          <h4 id="name-application-dnscbor">
<a href="#section-7.1.1" class="section-number selfRef">7.1.1. </a><a href="#name-application-dnscbor" class="section-name selfRef">"application/dns+cbor"</a>
          </h4>
<p id="section-7.1.1-1">Type name: application<a href="#section-7.1.1-1" class="pilcrow">¶</a></p>
<p id="section-7.1.1-2">Subtype name: dns+cbor<a href="#section-7.1.1-2" class="pilcrow">¶</a></p>
<p id="section-7.1.1-3">Required parameters: None<a href="#section-7.1.1-3" class="pilcrow">¶</a></p>
<p id="section-7.1.1-4">Optional parameters: packed<a href="#section-7.1.1-4" class="pilcrow">¶</a></p>
<p id="section-7.1.1-5">Encoding considerations: Must be encoded as using <span>[<a href="#RFC8949" class="cite xref">RFC8949</a>]</span>. See [TBD-this-spec] for details.<a href="#section-7.1.1-5" class="pilcrow">¶</a></p>
<p id="section-7.1.1-6">Security considerations: See <a href="#security-considerations" class="auto internal xref">Section 6</a> of this draft<a href="#section-7.1.1-6" class="pilcrow">¶</a></p>
<p id="section-7.1.1-7">Interoperability considerations: TBD<a href="#section-7.1.1-7" class="pilcrow">¶</a></p>
<p id="section-7.1.1-8">Published specification: [TBD-this-spec]<a href="#section-7.1.1-8" class="pilcrow">¶</a></p>
<p id="section-7.1.1-9">Applications that use this media type: TBD DNS over X systems<a href="#section-7.1.1-9" class="pilcrow">¶</a></p>
<p id="section-7.1.1-10">Fragment Identifier Considerations: TBD<a href="#section-7.1.1-10" class="pilcrow">¶</a></p>
<p id="section-7.1.1-11">Additional information:<a href="#section-7.1.1-11" class="pilcrow">¶</a></p>
<p id="section-7.1.1-12">   Deprecated alias names for this type: N/A<a href="#section-7.1.1-12" class="pilcrow">¶</a></p>
<p id="section-7.1.1-13">   Magic number(s): N/A<a href="#section-7.1.1-13" class="pilcrow">¶</a></p>
<p id="section-7.1.1-14">   File extension(s): dnsc<a href="#section-7.1.1-14" class="pilcrow">¶</a></p>
<p id="section-7.1.1-15">   Macintosh file type code(s): none<a href="#section-7.1.1-15" class="pilcrow">¶</a></p>
<p id="section-7.1.1-16">Person &amp; email address to contact for further information:
   IETF CBOR Working Group (cbor@ietf.org) or IETF Applications and Real-Time Area (art@ietf.org)<a href="#section-7.1.1-16" class="pilcrow">¶</a></p>
<p id="section-7.1.1-17">Intended usage: COMMON<a href="#section-7.1.1-17" class="pilcrow">¶</a></p>
<p id="section-7.1.1-18">Restrictions on Usage: None?<a href="#section-7.1.1-18" class="pilcrow">¶</a></p>
<p id="section-7.1.1-19">Author: Martine S. Lenders <a href="mailto:m.lenders@fu-berlin.de">m.lenders@fu-berlin.de</a><a href="#section-7.1.1-19" class="pilcrow">¶</a></p>
<p id="section-7.1.1-20">Change controller: IETF<a href="#section-7.1.1-20" class="pilcrow">¶</a></p>
<p id="section-7.1.1-21">Provisional registrations? No<a href="#section-7.1.1-21" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="coap-content-format-registration">
<section id="section-7.2">
        <h3 id="name-coap-content-format-registr">
<a href="#section-7.2" class="section-number selfRef">7.2. </a><a href="#name-coap-content-format-registr" class="section-name selfRef">CoAP Content-Format Registration</a>
        </h3>
<p id="section-7.2-1">IANA is requested to assign CoAP Content-Format ID for the new DNS message media
types in the "CoAP Content-Formats"
sub-registry, within the "CoRE Parameters" registry <span>[<a href="#RFC7252" class="cite xref">RFC7252</a>]</span>, corresponding the
"application/dns+cbor" media type specified in <a href="#media-type" class="auto internal xref">Section 7.1</a>:<a href="#section-7.2-1" class="pilcrow">¶</a></p>
<div id="cf-app-d-c">
<section id="section-7.2.1">
          <h4 id="name-application-dnscbor-2">
<a href="#section-7.2.1" class="section-number selfRef">7.2.1. </a><a href="#name-application-dnscbor-2" class="section-name selfRef">"application/dns+cbor"</a>
          </h4>
<p id="section-7.2.1-1">Media-Type: application/dns+cbor<a href="#section-7.2.1-1" class="pilcrow">¶</a></p>
<p id="section-7.2.1-2">Encoding: -<a href="#section-7.2.1-2" class="pilcrow">¶</a></p>
<p id="section-7.2.1-3">Id: TBD53<a href="#section-7.2.1-3" class="pilcrow">¶</a></p>
<p id="section-7.2.1-4">Reference: [TBD-this-spec]<a href="#section-7.2.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="applicationdnscborpacked1">
<section id="section-7.2.2">
          <h4 id="name-application-dnscborpacked1">
<a href="#section-7.2.2" class="section-number selfRef">7.2.2. </a><a href="#name-application-dnscborpacked1" class="section-name selfRef">"application/dns+cbor;packed=1"</a>
          </h4>
<p id="section-7.2.2-1">Media-Type: application/dns+cbor;packed=1<a href="#section-7.2.2-1" class="pilcrow">¶</a></p>
<p id="section-7.2.2-2">Encoding: -<a href="#section-7.2.2-2" class="pilcrow">¶</a></p>
<p id="section-7.2.2-3">Id: TBD54<a href="#section-7.2.2-3" class="pilcrow">¶</a></p>
<p id="section-7.2.2-4">Reference: [TBD-this-spec]<a href="#section-7.2.2-4" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="cbor-tags-registry">
<section id="section-7.3">
        <h3 id="name-cbor-tags-registry">
<a href="#section-7.3" class="section-number selfRef">7.3. </a><a href="#name-cbor-tags-registry" class="section-name selfRef">CBOR Tags Registry</a>
        </h3>
<p id="section-7.3-1">In the registry "<a href="https://www.iana.org/assignments/cbor-tags#cbor-tags" class="relref">CBOR Tags</a>" <span>[<a href="#IANA.cbor-tags" class="cite xref">IANA.cbor-tags</a>]</span>,
IANA is requested to allocate the tags defined in <a href="#tab-tag-values" class="auto internal xref">Table 1</a>.<a href="#section-7.3-1" class="pilcrow">¶</a></p>
<span id="name-values-for-tag-numbers"></span><div id="tab-tag-values">
<table class="center" id="table-1">
          <caption>
<a href="#table-1" class="selfRef">Table 1</a>:
<a href="#name-values-for-tag-numbers" class="selfRef">Values for Tag Numbers</a>
          </caption>
<thead>
            <tr>
              <th class="text-right" rowspan="1" colspan="1">Tag</th>
              <th class="text-left" rowspan="1" colspan="1">Data Item</th>
              <th class="text-left" rowspan="1" colspan="1">Semantics</th>
              <th class="text-left" rowspan="1" colspan="1">Reference</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-right" rowspan="1" colspan="1">TBD141</td>
              <td class="text-left" rowspan="1" colspan="1">array</td>
              <td class="text-left" rowspan="1" colspan="1">CBOR EDNS option record</td>
              <td class="text-left" rowspan="1" colspan="1">draft-lenders-dns-cbor</td>
            </tr>
            <tr>
              <td class="text-right" rowspan="1" colspan="1">TBD28259</td>
              <td class="text-left" rowspan="1" colspan="1">any</td>
              <td class="text-left" rowspan="1" colspan="1">Packed CBOR; implicit text string suffix sequence shared-item table</td>
              <td class="text-left" rowspan="1" colspan="1">draft-lenders-dns-cbor</td>
            </tr>
          </tbody>
        </table>
</div>
</section>
</div>
</section>
</div>
<div id="examples">
<section id="section-8">
      <h2 id="name-examples">
<a href="#section-8" class="section-number selfRef">8. </a><a href="#name-examples" class="section-name selfRef">Examples</a>
      </h2>
<div id="cddl-model-for-e-application-extension">
<section id="section-8.1">
        <h3 id="name-cddl-model-for-e-applicatio">
<a href="#section-8.1" class="section-number selfRef">8.1. </a><a href="#name-cddl-model-for-e-applicatio" class="section-name selfRef">CDDL model for <code>e''</code> application extension</a>
        </h3>
<p id="section-8.1-1"><a href="#fig_e-cddl-model" class="auto internal xref">Figure 15</a> shows the CDDL model used for the <code>e''</code> application extension (see
<span>[<a href="#I-D.ietf-cbor-edn-e-ref" class="cite xref">I-D.ietf-cbor-edn-e-ref</a>]</span>) in our examples.
<code>C-</code> contants define DNS classes as unsigned integers from the "DNS CLASSes" sub-registry of the
IANA "Domain Name System (DNS) Parameters" registry.
<code>RR-</code> constants define resource record types from the "Resource Record (RR) TYPEs" sub-registry of
the IANA "Domain Name System (DNS) Parameters" registry.<a href="#section-8.1-1" class="pilcrow">¶</a></p>
<span id="name-cddl-model-defining-constan"></span><div id="fig_e-cddl-model">
<figure id="figure-15">
          <div class="lang-cddl sourcecode" id="section-8.1-2.1">
<pre>
C-IN = 1
C-ANY = 255

RR-A = 1
RR-NS = 2
RR-CNAME = 5
RR-PTR = 12
RR-AAAA = 28
RR-ANY = 255
</pre>
</div>
<figcaption><a href="#figure-15" class="selfRef">Figure 15</a>:
<a href="#name-cddl-model-defining-constan" class="selfRef">CDDL model defining constants for this document for e''.</a>
          </figcaption></figure>
</div>
</section>
</div>
<div id="sec_query-examples">
<section id="section-8.2">
        <h3 id="name-dns-queries-2">
<a href="#section-8.2" class="section-number selfRef">8.2. </a><a href="#name-dns-queries-2" class="section-name selfRef">DNS Queries</a>
        </h3>
<p id="section-8.2-1">A DNS query of the record <code>AAAA</code> in class <code>IN</code> for name "example.org" is
represented in CBOR extended diagnostic notation (EDN) <span>[<a href="#I-D.ietf-cbor-edn-literals" class="cite xref">I-D.ietf-cbor-edn-literals</a>]</span> with <code>e''</code>
application extension <span>[<a href="#I-D.ietf-cbor-edn-e-ref" class="cite xref">I-D.ietf-cbor-edn-e-ref</a>]</span> as follows:<a href="#section-8.2-1" class="pilcrow">¶</a></p>
<div class="lang-edn sourcecode" id="section-8.2-2">
<pre>
[["example", "org"]]
</pre><a href="#section-8.2-2" class="pilcrow">¶</a>
</div>
<p id="section-8.2-3">The binary (in hexadecimal encoding) of the query looks as follows (14 bytes):<a href="#section-8.2-3" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-8.2-4">
<pre>
81                      # array(1)
   82                   # array(2)
      67                # text(7)
         6578616d706c65 # "example"
      63                # text(3)
         6f7267         # "org"
</pre><a href="#section-8.2-4" class="pilcrow">¶</a>
</div>
<p id="section-8.2-5">A query of an <code>A</code> record for the same name is represented as<a href="#section-8.2-5" class="pilcrow">¶</a></p>
<div class="lang-edn sourcecode" id="section-8.2-6">
<pre>
[["example", "org", e'RR-A']]
</pre><a href="#section-8.2-6" class="pilcrow">¶</a>
</div>
<p id="section-8.2-7">or in binary (15 bytes)<a href="#section-8.2-7" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-8.2-8">
<pre>
81                      # array(1)
   83                   # array(3)
      67                # text(7)
         6578616d706c65 # "example"
      63                # text(3)
         6f7267         # "org"
      01                # e'RR-A' (unsigned(1))
</pre><a href="#section-8.2-8" class="pilcrow">¶</a>
</div>
<p id="section-8.2-9">A query of <code>ANY</code> record for that name is represented as<a href="#section-8.2-9" class="pilcrow">¶</a></p>
<div class="lang-edn sourcecode" id="section-8.2-10">
<pre>
[["example", "org", e'RR-ANY', e'C-ANY']]
</pre><a href="#section-8.2-10" class="pilcrow">¶</a>
</div>
<p id="section-8.2-11">or in binary (18 bytes)<a href="#section-8.2-11" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-8.2-12">
<pre>
81                      # array(1)
   84                   # array(4)
      67                # text(7)
         6578616d706c65 # "example"
      63                # text(3)
         6f7267         # "org"
      18 ff             # e'RR-ANY' (unsigned(255))
      18 ff             # e'RR-ANY' (unsigned(255))
</pre><a href="#section-8.2-12" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="sec_name-compression-example">
<section id="section-8.3">
        <h3 id="name-name-compression-2">
<a href="#section-8.3" class="section-number selfRef">8.3. </a><a href="#name-name-compression-2" class="section-name selfRef">Name Compression</a>
        </h3>
<p id="section-8.3-1">Take the following response <em>o</em> in CBOR extended diagnostic notation (EDN) <span>[<a href="#I-D.ietf-cbor-edn-literals" class="cite xref">I-D.ietf-cbor-edn-literals</a>]</span>.
It contains a question for the "www.example.org" AAAA record, with a "svc.www.example.org" CNAME answer and its AAAA record, as well as the "org.example.org" NS record for the "example.org" domain in the authority section, each record with TTL 3600:<a href="#section-8.3-1" class="pilcrow">¶</a></p>
<span id="name-unpacked-example-for-implic"></span><div id="fig_name-compression-example-unpacked">
<figure id="figure-16">
          <div class="lang-edn sourcecode" id="section-8.3-2.1">
<pre>
[
  ["www", "example", "org"],
  [
    [3600, "www", "example", "org", e'RR-CNAME', "svc", "www", "example", "org"],
    [3600, "svc", "www", "example", "org", ip'2001:db8::1']
  ],
  [
    [3600, "example", "org", e'RR-NS', "org", "example", "org"]
  ],
  []
]
</pre>
</div>
<figcaption><a href="#figure-16" class="selfRef">Figure 16</a>:
<a href="#name-unpacked-example-for-implic" class="selfRef">Unpacked example for implicit name compression.</a>
          </figcaption></figure>
</div>
<p id="section-8.3-3">The object <em>o</em> would be sent over the wire as the following 136 bytes of binary data, represented
here with hexadecimal encoding (type and data noted in comment).<a href="#section-8.3-3" class="pilcrow">¶</a></p>
<span id="name-binary-of-the-unpacked-exam"></span><div id="fig_name-compression-example-unpacked-binary">
<figure id="figure-17">
          <div class="alignLeft art-text artwork" id="section-8.3-4.1">
<pre>
84                                      # array(4)
   83                                   # array(3)
      63                                # text(3)
         777777                         # "www"
      67                                # text(7)
         6578616D706C65                 # "example"
      63                                # text(3)
         6F7267                         # "org"
   82                                   # array(2)
      89                                # array(9)
         19 0E10                        # unsigned(3600)
         63                             # text(3)
            777777                      # "www"
         67                             # text(7)
            6578616D706C65              # "example"
         63                             # text(3)
            6F7267                      # "org"
         05                             # e'RR-CNAME' (unsigned(5))
         63                             # text(3)
            737663                      # "svc"
         63                             # text(3)
            777777                      # "www"
         67                             # text(7)
            6578616D706C65              # "example"
         63                             # text(3)
            6F7267                      # "org"
      86                                # array(6)
         19 0E10                        # unsigned(3600)
         63                             # text(3)
            737663                      # "svc"
         63                             # text(3)
            777777                      # "www"
         67                             # text(7)
            6578616D706C65              # "example"
         63                             # text(3)
            6F7267                      # "org"
         50                             # bytes(16)
            20010DB8000000000000000000000001 # ip'2001:db8::1'
   81                                   # array(1)
      87                                # array(7)
         19 0E10                        # unsigned(3600)
         67                             # text(7)
            6578616D706C65              # "example"
         63                             # text(3)
            6F7267                      # "org"
         02                             # e'RR-NS' (unsigned(2))
         63                             # text(3)
            6F7267                      # "org"
         67                             # text(7)
            6578616D706C65              # "example"
         63                             # text(3)
            6F7267                      # "org"
   80                                   # array(0)
</pre>
</div>
<figcaption><a href="#figure-17" class="selfRef">Figure 17</a>:
<a href="#name-binary-of-the-unpacked-exam" class="selfRef">Binary of the unpacked example for implicit name compression (136 bytes).</a>
          </figcaption></figure>
</div>
<p id="section-8.3-5">This would generate the following virtual table <em>V</em>.<a href="#section-8.3-5" class="pilcrow">¶</a></p>
<span id="name-implicit-table-of-shared-it"></span><div id="fig_name-compression-example-table">
<figure id="figure-18">
          <div class="lang-edn sourcecode" id="section-8.3-6.1">
<pre>
[
    /index 0:/ 1115(["www", "example", "org"]),
    /index 1:/ 1115(["example", "org"]),
    /index 2:/ 1115(["org"]),
    /index 3:/ 1115(["svc", "www", "example", "org"]),
    /index 4:/ 1115(["org", "example", "org"])
]
</pre>
</div>
<figcaption><a href="#figure-18" class="selfRef">Figure 18</a>:
<a href="#name-implicit-table-of-shared-it" class="selfRef">Implicit table of shared items for the example _o_.</a>
          </figcaption></figure>
</div>
<p id="section-8.3-7">An implementation <span class="bcp14">MAY</span> choose to use references here to reduce memory consumption, as represented in <a href="#fig_name-compression-example-table-comp" class="auto internal xref">Figure 19</a>.
Circular references are not possible due to the construction algorithm of <em>V</em>.<a href="#section-8.3-7" class="pilcrow">¶</a></p>
<span id="name-implicit-table-of-shared-ite"></span><div id="fig_name-compression-example-table-comp">
<figure id="figure-19">
          <div class="lang-edn sourcecode" id="section-8.3-8.1">
<pre>
[
    /index 0:/ 1115(["www", "example", "org"]),
    /index 1:/ 1115(["example", "org"]),
    /index 2:/ 1115(["org"]),
    /index 3:/ 1115(["svc", simple(0)]),
    /index 4:/ 1115(["org", simple(1)])
]
</pre>
</div>
<figcaption><a href="#figure-19" class="selfRef">Figure 19</a>:
<a href="#name-implicit-table-of-shared-ite" class="selfRef">Implicit table of shared items for the example _o_ with self-references.</a>
          </figcaption></figure>
</div>
<p id="section-8.3-9">Note that the sequence "org", simple(0) is added at index 4 with leading "org", instead of referencing index 2 + index 1 (<code>simple(2), simple(1)</code>), as it is its own distinct suffix sequence.
However, its suffix "example", "org" is not added to the table again, as it is already present at index 1.<a href="#section-8.3-9" class="pilcrow">¶</a></p>
<p id="section-8.3-10">Assuming media type "application/dns+cbor;packed=0" (i.e., an implicit tag TBD28259), the packed representation of <em>o</em> would thus be:<a href="#section-8.3-10" class="pilcrow">¶</a></p>
<span id="name-the-packed-representation-o"></span><div id="fig_name-compression-example-packed">
<figure id="figure-20">
          <div class="lang-edn sourcecode" id="section-8.3-11.1">
<pre>
[
  ["www", "example", "org"],
  [
    [
      3600,
      simple(0) / expands to "www", "example", "org" /,
      e'RR-CNAME',
      "svc",
      simple(0) / expands to "www", "example", "org" /
    ],
    [
      3600,
      simple(3) / expands to "svc", "www", "example", "org" /
      ip'2001:db8::1'
    ]
  ],
  [
    [
      3600,
      simple(1) / expands to "example", "org" /,
      e'RR-NS',
      "org",
      simple(1) / expands to "example", "org" /,
    ]
  ],
  []
]
</pre>
</div>
<figcaption><a href="#figure-20" class="selfRef">Figure 20</a>:
<a href="#name-the-packed-representation-o" class="selfRef">The packed representation of the name compression example.</a>
          </figcaption></figure>
</div>
<p id="section-8.3-12">In binary the packed representation of <em>o</em> would be:<a href="#section-8.3-12" class="pilcrow">¶</a></p>
<span id="name-binary-of-the-packed-repres"></span><div id="fig_name-compression-example-packed-binary">
<figure id="figure-21">
          <div class="alignLeft art-text artwork" id="section-8.3-13.1">
<pre>
84                                   # array(4)
   83                                # array(3)
      63                             # text(3)
         777777                      # "www"
      67                             # text(7)
         6578616D706C65              # "example"
      63                             # text(3)
         6F7267                      # "org"
   82                                # array(2)
      85                             # array(5)
         19 0E10                     # unsigned(3600)
         E0                          # simple(0)
         05                          # e'RR-CNAME' (unsigned(5))
         63                          # text(3)
            737663                   # "svc"
         E0                          # simple(0)
      83                             # array(3)
         19 0E10                     # unsigned(3600)
         E3                          # simple(3)
         50                          # bytes(16)
            20010DB8000000000000000000000001 # ip'2001:db8::1'
   81                                # array(1)
      85                             # array(5)
         19 0E10                     # unsigned(3600)
         E1                          # simple(1)
         02                          # e'RR-NS' (unsigned(2))
         63                          # text(3)
            6F7267                   # "org"
         E1                          # simple(1)
   80                                # array(0)
</pre>
</div>
<figcaption><a href="#figure-21" class="selfRef">Figure 21</a>:
<a href="#name-binary-of-the-packed-repres" class="selfRef">Binary of the packed representation of the example (65 bytes).</a>
          </figcaption></figure>
</div>
</section>
</div>
<div id="sec_response-examples">
<section id="section-8.4">
        <h3 id="name-dns-responses-2">
<a href="#section-8.4" class="section-number selfRef">8.4. </a><a href="#name-dns-responses-2" class="section-name selfRef">DNS Responses</a>
        </h3>
<p id="section-8.4-1">The responses to the examples provided in <a href="#sec_query-examples" class="auto internal xref">Section 8.2</a> are shown
below. We use the CBOR extended diagnostic notation (EDN) (see <span>[<a href="#I-D.ietf-cbor-edn-literals" class="cite xref">I-D.ietf-cbor-edn-literals</a>]</span> and <span><a href="https://rfc-editor.org/rfc/rfc8610#appendix-G" class="relref">Appendix G</a> of [<a href="#RFC8610" class="cite xref">RFC8610</a>]</span>)
with <code>e''</code> application extension <span>[<a href="#I-D.ietf-cbor-edn-e-ref" class="cite xref">I-D.ietf-cbor-edn-e-ref</a>]</span>,
most notably the "ip" extension to represent binary IP addresses as a IP address app-string literal.<a href="#section-8.4-1" class="pilcrow">¶</a></p>
<p id="section-8.4-2">To represent an <code>AAAA</code> record with TTL 300 seconds for the IPv6 address 2001:db8::1, a minimal
response to <code>[["example", "org"]]</code> could be<a href="#section-8.4-2" class="pilcrow">¶</a></p>
<div class="lang-edn sourcecode" id="section-8.4-3">
<pre>
[[[300, ip'2001:db8::1']]]
</pre><a href="#section-8.4-3" class="pilcrow">¶</a>
</div>
<p id="section-8.4-4">or in binary (23 bytes)<a href="#section-8.4-4" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-8.4-5">
<pre>
81                                            # array(1)
   81                                         # array(1)
      82                                      # array(2)
         19 012c                              # unsigned(300)
         50                                   # bytes(16)
            20010db8000000000000000000000001  # ip'2001:db8::1'
</pre><a href="#section-8.4-5" class="pilcrow">¶</a>
</div>
<p id="section-8.4-6">In this case, the name is derived from the query.<a href="#section-8.4-6" class="pilcrow">¶</a></p>
<p id="section-8.4-7">If the name or the context is required, the following response would also
be valid:<a href="#section-8.4-7" class="pilcrow">¶</a></p>
<div class="lang-edn sourcecode" id="section-8.4-8">
<pre>
[[["example", "org", 300, ip'2001:db8::1']]]
</pre><a href="#section-8.4-8" class="pilcrow">¶</a>
</div>
<p id="section-8.4-9">In binary that response looks like the following (35 bytes):<a href="#section-8.4-9" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-8.4-10">
<pre>
81                                            # array(1)
   81                                         # array(1)
      84                                      # array(4)
         67                                   # text(7)
            6578616d706c65                    # "example"
         63                                   # text(3)
            6f7267                            # "org"
         19 012c                              # unsigned(300)
         50                                   # bytes(16)
            20010db8000000000000000000000001  # ip'2001:db8::1'
</pre><a href="#section-8.4-10" class="pilcrow">¶</a>
</div>
<p id="section-8.4-11">If the query can not be mapped to the response for some reason, a response
would look like:<a href="#section-8.4-11" class="pilcrow">¶</a></p>
<div class="lang-edn sourcecode" id="section-8.4-12">
<pre>
[["example", "org"], [[300, ip'2001:db8::1']]]
</pre><a href="#section-8.4-12" class="pilcrow">¶</a>
</div>
<p id="section-8.4-13">In binary that response looks like the following (36 bytes):<a href="#section-8.4-13" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-8.4-14">
<pre>
82                                            # array(2)
   82                                         # array(2)
      67                                      # text(7)
         6578616d706c65                       # "example"
      63                                      # text(3)
         6f7267                               # "org"
   81                                         # array(1)
      82                                      # array(2)
         19 012c                              # unsigned(300)
         50                                   # bytes(16)
            20010db8000000000000000000000001  # ip'2001:db8::1'
</pre><a href="#section-8.4-14" class="pilcrow">¶</a>
</div>
<p id="section-8.4-15">To represent a minimal response of an <code>A</code> record with TTL 3600 seconds for the IPv4 address
192.0.2.1, a minimal response to <code>[["example", "org", 1]]</code> could be<a href="#section-8.4-15" class="pilcrow">¶</a></p>
<div class="lang-edn sourcecode" id="section-8.4-16">
<pre>
[[[300, ip'192.0.2.1']]]
</pre><a href="#section-8.4-16" class="pilcrow">¶</a>
</div>
<p id="section-8.4-17">or in binary (11 bytes)<a href="#section-8.4-17" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-8.4-18">
<pre>
81                   # array(1)
   81                # array(1)
      82             # array(2)
         19 012c     # unsigned(300)
         44          # bytes(4)
            c0000201 # ip'192.0.2.1'
</pre><a href="#section-8.4-18" class="pilcrow">¶</a>
</div>
<p id="section-8.4-19">Note that here also the 1 of record type <code>A</code> can be elided, as this record
type is specified in the question section.<a href="#section-8.4-19" class="pilcrow">¶</a></p>
<p id="section-8.4-20">Lastly, a response to <code>[["example", "org", e'RR-ANY', e'C-ANY']]</code> could be<a href="#section-8.4-20" class="pilcrow">¶</a></p>
<div class="breakable lang-edn sourcecode" id="section-8.4-21">
<pre>
[
  # PTR (12) question for "example.org"
  [
    # appends 0 =&gt; ["example", "org"] to virtual packing table
    "example",
    # appends 1 =&gt; ["org"] to virtual packing table
    "org",
    e'RR-PTR'
  ],
  # Answer section:
  [[
    # PTR (12) for "example.org"
    # (both elided since they are the same as in question)
    # is "_coap._udp.local" with TTL 3600
    3600,
    # appends 2 =&gt; ["_coap", "_udp", "local"] to virtual packing table
    "_coap",
    # appends 3 =&gt; ["_udp", "local"] to virtual packing table
    "_udp",
    # appends 4 =&gt; ["local"] to virtual packing table
    "local"
  ]],
  # Authority section:
  [
    [
      # NS (2) for "example.org"
      # (name elided since its the same as in question)
      # is "ns1.example.org" with TTL 3600
      3600, e'RR-NS',
      # appends 5 =&gt; ["ns1", simple(0)] to virtual packing table
      "ns1", simple(0)  # expands to ["example", "org"]
    ],
    [
      # NS (2) for "example.org"
      # (name elided since its the same as in question)
      # is "ns2.example.org" with TTL 3600
      3600, e'RR-NS',
      # appends 6 =&gt; ["ns2", simple(0)] to virtual packing table
      "ns2", simple(0)  # expands to ["example", "org"]
    ]
  ],
  # Additional section
  [
    [
      # AAAA (28) for "_coap._udp.local"
      # is 2001:db8::1 with TTL 3600
      simple(2),    # expands to ["_coap", "_udp", "local"]
      3600, e'RR-AAAA', ip'2001:db8::1'
    ],
    [
      # AAAA (28) for "_coap._udp.local"
      # is 2001:db8::2 with TTL 3600
      simple(2),    # expands to ["_coap", "_udp", "local"]
      3600, e'RR-AAAA', ip'2001:db8::2'
    ],
    [
      # AAAA (28) for "ns1.example.org"
      # is 2001:db8::35 with TTL 3600
      simple(5),    # expands to ["ns1", ["example", "org"]]
      3600, e'RR-AAAA', ip'2001:db8::35'
    ],
    [
      # AAAA (28) for "ns2.example.org"
      # is 2001:db8::3535 with TTL 3600
      simple(6),    # expands to ["ns2", ["example", "org"]
      3600, e'RR-AAAA', ip'2001:db8::3535'
    ]
  ]
]
</pre><a href="#section-8.4-21" class="pilcrow">¶</a>
</div>
<p id="section-8.4-22">or in binary (155 bytes)<a href="#section-8.4-22" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-8.4-23">
<pre>
84                                            # array(4)
   83                                         # array(3)
      67                                      # text(7)
         6578616d706c65                       # "example"
      63                                      # text(3)
         6f7267                               # "org"
      0c                                      # e'RR-PTR' (unsigned(12))
   81                                         # array(1)
      84                                      # array(4)
         19 0e10                              # unsigned(3600)
         65                                   # text(5)
            5f636f6170                        # "_coap"
         64                                   # text(4)
            5f756470                          # "_udp"
         65                                   # text(5)
            6c6f63616c                        # "local"
   82                                         # array(2)
      84                                      # array(4)
         19 0e10                              # unsigned(3600)
         02                                   # e'RR-NS' (unsigned(2))
         63                                   # text(3)
            6e7331                            # "ns1"
         e0                                   # simple(0)
      84                                      # array(4)
         19 0e10                              # unsigned(3600)
         02                                   # e'RR-NS' (unsigned(2))
         63                                   # text(3)
            6e7332                            # "ns2"
         e0                                   # simple(0)
   84                                         # array(4)
      84                                      # array(4)
         e2                                   # simple(2)
         19 0e10                              # unsigned(3600)
         18 1c                                # e'RR-AAAA' (unsigned(28))
         50                                   # bytes(16)
            20010db8000000000000000000000001  # ip'2001:db8::1'
      84                                      # array(4)
         e2                                   # simple(2)
         19 0e10                              # unsigned(3600)
         18 1c                                # e'RR-AAAA' (unsigned(28))
         50                                   # bytes(16)
            20010db8000000000000000000000002  # ip'2001:db8::2'
      84                                      # array(4)
         e5                                   # simple(5)
         19 0e10                              # unsigned(3600)
         18 1c                                # e'RR-AAAA' (unsigned(28))
         50                                   # bytes(16)
            20010db8000000000000000000000035  # ip'2001:db8::35'
      84                                      # array(4)
         e6                                   # simple(6)
         19 0e10                              # unsigned(3600)
         18 1c                                # e'RR-AAAA' (unsigned(28))
         50                                   # bytes(16)
            20010db8000000000000000000003535  # ip'2001:db8::3535'
</pre><a href="#section-8.4-23" class="pilcrow">¶</a>
</div>
<p id="section-8.4-24">This response advertises two local CoAP servers (identified by service name _coap._udp.local) at
2001:db8::1 and 2001:db8::2 and two nameservers for the example.org domain, ns1.example.org at
2001:db8::35 and ns2.example.org at 2001:db8::3535. Each of the transmitted records has a TTL of
3600 seconds.
Note the use of name compression (see <a href="#sec_name-compression" class="auto internal xref">Section 4.1</a>) in this example.<a href="#section-8.4-24" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sec_packed-cbor-example">
<section id="section-8.5">
        <h3 id="name-name-compression-and-packed">
<a href="#section-8.5" class="section-number selfRef">8.5. </a><a href="#name-name-compression-and-packed" class="section-name selfRef">Name Compression and Packed CBOR</a>
        </h3>
<p id="section-8.5-1"><a href="#fig_name-compression-example-packed-113" class="auto internal xref">Figure 22</a> shows the example from <a href="#fig_name-compression-example-unpacked" class="auto internal xref">Figure 16</a> with "packed=1".<a href="#section-8.5-1" class="pilcrow">¶</a></p>
<span id="name-the-packed-representation-of"></span><div id="fig_name-compression-example-packed-113">
<figure id="figure-22">
          <div class="lang-edn sourcecode" id="section-8.5-2.1">
<pre>
[
  ["org", 3600],
  [
    ["www", "example", simple(0) / expands to "org" /],
    [
      [
        simple(1) / expands to 3600 /,
        simple(2) / expands to "www", "example", "org" /,
        e'RR-CNAME',
        "svc",
        simple(2) / expands to "www", "example", "org" /
      ],
      [
        simple(1) / expands to 3600,
        simple(5) / expands to "svc", "www", "example", "org" /
        ip'2001:db8::1'
      ]
    ],
    [
      [
        simple(1) / expands to 3600 /,
        simple(3) / expands to "example", "org" /,
        e'RR-NS',
        simple(0) / expands to "org" /,
        simple(3) / expands to "example", "org" /,
      ]
    ],
    []
  ]
]
</pre>
</div>
<figcaption><a href="#figure-22" class="selfRef">Figure 22</a>:
<a href="#name-the-packed-representation-of" class="selfRef">The packed representation of the example of a message marked with "application/dns+cbor;packed=1".</a>
          </figcaption></figure>
</div>
<p id="section-8.5-3">Note, that the encoder needs to rewrite the references from <a href="#fig_name-compression-example-unpacked" class="auto internal xref">Figure 16</a> as the implicit table <em>V</em> is appended to the shared argument table <code>["org", 600]</code>.<a href="#section-8.5-3" class="pilcrow">¶</a></p>
<p id="section-8.5-4">In binary, that example looks like the following (represented in hexadecimal):<a href="#section-8.5-4" class="pilcrow">¶</a></p>
<span id="name-the-binary-of-the-packed-re"></span><div id="fig_name-compression-example-packed-113-binary">
<figure id="figure-23">
          <div class="alignLeft art-text artwork" id="section-8.5-5.1">
<pre>
82                                      # array(2)
   82                                   # array(2)
      63                                # text(3)
         6F7267                         # "org"
      19 0E10                           # unsigned(600)
   84                                   # array(4)
      83                                # array(3)
         63                             # text(3)
            777777                      # "www"
         67                             # text(7)
            6578616D706C65              # "example"
         E0                             # simple(0)
      82                                # array(2)
         85                             # array(5)
            E1                          # simple(1)
            E2                          # simple(2)
            05                          # e'RR-CNAME' (unsigned(5))
            63                          # text(3)
               737663                   # "svc"
            E2                          # simple(2)
         83                             # array(3)
            E1                          # simple(1)
            E5                          # simple(5)
            50                          # bytes(16)
               20010DB8000000000000000000000001 # ip'2001:db8::1'
      81                                # array(1)
         85                             # array(5)
            E1                          # unsigned(600)
            E3                          # simple(3)
            02                          # e'RR-NS' (unsigned(2))
            E0                          # simple(0)
            E3                          # simple(3)
      80                                # array(0)
</pre>
</div>
<figcaption><a href="#figure-23" class="selfRef">Figure 23</a>:
<a href="#name-the-binary-of-the-packed-re" class="selfRef">The binary of the packed representation of the example marked with "application/dns+cbor;packed=1" (62 bytes).</a>
          </figcaption></figure>
</div>
<p id="section-8.5-6">Implicitly, a decoder would interpret this as the following EDN:<a href="#section-8.5-6" class="pilcrow">¶</a></p>
<span id="name-the-explicit-interpretation"></span><div id="fig_expl-name-compression-example-packed-113">
<figure id="figure-24">
          <div class="lang-edn sourcecode" id="section-8.5-7.1">
<pre>
TBD113(
  [
    ["org", 3600],
    TBD28259(
      [
        ["www", "example", simple(0)],
        [
          [
            simple(1),
            simple(2) / expands to "www", "example", "org" /,
            e'RR-CNAME',
            "svc",
            simple(2) / expands to "www", "example", "org" /
          ],
          [
            simple(1),
            simple(5) / expands to "svc", "www", "example", "org" /
            ip'2001:db8::1'
          ]
        ],
        [
          [
            simple(1),
            simple(3) / expands to "example", "org" /,
            e'RR-NS',
            simple(0),
            simple(3) / expands to "example", "org" /,
          ]
        ],
        []
      ]
    )
  ]
)
</pre>
</div>
<figcaption><a href="#figure-24" class="selfRef">Figure 24</a>:
<a href="#name-the-explicit-interpretation" class="selfRef">The explicit interpretation of the packed representation of the example of a message marked with "application/dns+cbor;packed=1".</a>
          </figcaption></figure>
</div>
<div id="example-decoder">
<section id="section-8.5.1">
          <h4 id="name-example-decoder">
<a href="#section-8.5.1" class="section-number selfRef">8.5.1. </a><a href="#name-example-decoder" class="section-name selfRef">Example Decoder</a>
          </h4>
<p id="section-8.5.1-1">A decoder to interpret an object like the one in <a href="#fig_name-compression-example-packed-113" class="auto internal xref">Figure 22</a> would have the following pseudo-code:<a href="#section-8.5.1-1" class="pilcrow">¶</a></p>
<span id="name-pseudo-code-for-an-example-"></span><div id="fig_28259-113-decoder">
<figure id="figure-25">
            <div class="alignLeft art-text artwork" id="section-8.5.1-2.1">
<pre>
function decode_cbor_dns(binary: bytes, packed: uint = 0): CBORObject {
  obj: CBORObject = cbor.decode(binary)
  unpacker: Unpacker = Unpacker()
  match (packed) {
    when 0 then {
      packing_table = []
      rump = obj
    },
    when 1 then {
      /* except explicit 113 */
      if (typeof(obj) is CBORTag and tag-number of obj == 113) {
        obj = tag-content of obj
      }

      assume that typeof(obj) is CBORArray and obj.length == 2
      assume that typeof(obj[0]) is CBORArray  # packing table

      /* step into tag 113 context for unpacker with all its references
       * (simple values and tag 6) and function tags */
      Tell `unpacker` that we are in rump of tag 113 now

      /* prepend to current packing table of unpacker */
      unpacker.packing_table = obj[0] concat unpacker.packing_table
      rump = obj[1]
    },
    when anything else then {
      throw "Not supported yet!"
    },
  }

  return unpack_names(rump, unpacker)
}

function unpack_names(rump: Any, unpacker: Unpacker): CBORObject {
  /* except explicit 28259 */
  if (typeof(rump) is CBORTag and tag-number of rump == 28259) {
    rump = tag-content of rump
  }

  /* step into tag 28259 context for unpacker with all its references
   * (simple values and tag 6) */
  Tell `unpacker` that we are in rump of tag 28259 now

  return recursive_unpack_names(rump, unpacker, unpacker.packing_table.length)
}

function is_splice_tag(obj: CBORObject): bool {
  return (typeof(packed_idx) is CBORTag and tag-number of packed_idx == 1115)
}

function recursive_unpack_names(
    obj: CBORObject, unpacker: Unpacker, outer_table_len: Integer
): CBORObject {
  match typeof(obj) {
    when CBORInt, CBORByteString, or CBORTextString then {
      return obj
    }
    when CBORArray then {
      result: CBORArray = []
      /* name_start_idx will point to first element of a name and its suffixes
       * in the packing table */
      name_start_idx: CBORInt or null = null
      for (elem in obj) {
        if (typeof(elem) is CBORTextString) {
          /* Create a local name reference in packing table for this name
           * and all its suffixes */
          if (name_start_idx is null) {
            unpacker.packing_table = unpacker.packing_table concat [
              CBORTag(tag-number = 1115, tag-content = []))
            ]
            name_start_idx = unpacker.packing_table.length - 1
          }
          else {
            /* create packing table entry for new suffix */
            unpacker.packing_table = unpacker.packing_table concat [
              CBORTag(tag-number = 1115, tag-content = []))
            ]
          }

          /* Append to all suffixes in local name reference */
          for (i from i == name_start_idx
                 to i &lt; unpacker.packing_table.length)) {
            append elem to tag-content of unpacker.packing_table[i]
          }
          append elem to result
        }
        elif (unpacker.is_shared_reference(elem)) {   /* is simple() or 6() */
          /* calculate index from simple() or 6() */
          ref_idx: uint = unpacker.ref_idx(elem)
          assume that (ref_idx &lt; unpacker.packing_table.length)

          packed_obj: CBORObject = unpacker.packing_table[ref_idx]

          /* check if this reference is part of a longer name */
          if (is_splice_tag(packed_obj) or
              typeof(packed_obj) is CBORTextString) {
            if (name_start_idx is not null) {
              /* if name_start_idx is already set, append to all suffixes
               * from name_start_idx to end of packing table */
              for (i from i == name_start_idx
                     to i &lt; unpacker.packing_table.length)) {
                append elem to tag-content of unpacker.packing_table[i]
              }

              /* check if ref_idx references implicit table V */
              if (ref_idx &gt; outer_table_len) {
                /* close name_start_idx pointing to first element of name
                 * sequence, as only CBORTextStrings (including those
                 * referenced in outer tables) continue the name */
                name_start_idx = null
              }
            }
          }
          if (is_splice_tag(packed_obj)) {
            /* name suffix is spliced in */
            assume that (
              typeof(tag-content of packed_obj) is CBORArray containing
              only CBORTextString and references to CBORTextSTring
            )
            result = result concat tag-content of packed_obj
          }
          else {
            append packed_obj to result
          }
        }
        else {
          /* not part of a name anymore, so close name_start_idx pointing to
           * first element of name sequence */
          name_start_idx = null
          match typeof(elem) {
            /* step into arrays and tags */
            when CBORArray then {
              result = result concat recursive_unpack_names(
                  elem, unpacker, outer_table_len
              )
            }
            when CBORTag then {
              append CBORTag(
                tag-number = tag-number of elem,
                tag-content = recursive_unpack_names(
                    tag-content of elem, unpacker, outer_table_len
                ),
              ) to result
            }
            when CBORMap then {
              throw warning "Ignore maps which are not part of this spec"
            }
            when anything else then {
              append elem to result
            }
          }
        }
      }
      return result
    }
    when anything else then {
      throw warning "Ignore other types not part of this spec"
    }
  }
}
</pre>
</div>
<figcaption><a href="#figure-25" class="selfRef">Figure 25</a>:
<a href="#name-pseudo-code-for-an-example-" class="selfRef">Pseudo-code for an example decoder</a>
            </figcaption></figure>
</div>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="sec_comparison-to-classic-dns">
<section id="section-9">
      <h2 id="name-comparison-to-classic-dns-w">
<a href="#section-9" class="section-number selfRef">9. </a><a href="#name-comparison-to-classic-dns-w" class="section-name selfRef">Comparison to Classic DNS Wire Format</a>
      </h2>
<p id="section-9-1"><a href="#tab-cbor-comparison" class="auto internal xref">Table 2</a> shows a comparison between the classic DNS wire format and the
application/dns+cbor format. Note that the worst case results typically appear only rarely in DNS.
The classic DNS format is preferred in those cases. A key for which configuration was used in which
case can be seen in <a href="#tab-cbor-comparison-key" class="auto internal xref">Table 3</a>. Any name label that is longer than 23 bytes adds
a name overhead of 1 byte to its CBOR type header.<span class="cref" id="_10">TBD: Also add structured RRs?.<span class="crefSource">—mlenders</span></span><a href="#section-9-1" class="pilcrow">¶</a></p>
<span id="name-comparison-of-application-d"></span><div id="tab-cbor-comparison">
<table class="center" id="table-2">
        <caption>
<a href="#table-2" class="selfRef">Table 2</a>:
<a href="#name-comparison-of-application-d" class="selfRef">Comparison of application/dns+cbor to classic DNS format.</a>
        </caption>
<thead>
          <tr>
            <th class="text-left" rowspan="2" colspan="1">Item</th>
            <th class="text-right" rowspan="2" colspan="1">Classic DNS format [bytes]</th>
            <th class="text-center" rowspan="1" colspan="3">application/dns+cbor [bytes]</th>
          </tr>
          <tr>
            <th class="text-right" rowspan="1" colspan="1">best case</th>
            <th class="text-right" rowspan="1" colspan="1">realistic worst case</th>
            <th class="text-right" rowspan="1" colspan="1">theoretical worst case</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">Header (ID &amp; Flags)</td>
            <td class="text-right" rowspan="1" colspan="1">4</td>
            <td class="text-right" rowspan="1" colspan="1">1</td>
            <td class="text-right" rowspan="1" colspan="1">4</td>
            <td class="text-right" rowspan="1" colspan="1">4</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">Count fields</td>
            <td class="text-right" rowspan="1" colspan="1">2</td>
            <td class="text-right" rowspan="1" colspan="1">1</td>
            <td class="text-right" rowspan="1" colspan="1">3</td>
            <td class="text-right" rowspan="1" colspan="1">3</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">Question section</td>
            <td class="text-right" rowspan="1" colspan="1">6 + name len.</td>
            <td class="text-right" rowspan="1" colspan="1">2 + name len.</td>
            <td class="text-right" rowspan="1" colspan="1">6 + name len. + name overhead</td>
            <td class="text-right" rowspan="1" colspan="1">9 + name len. + name overhead</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">Standard RR</td>
            <td class="text-right" rowspan="1" colspan="1">12 + name len. + rdata len.</td>
            <td class="text-right" rowspan="1" colspan="1">3        <br>
 + rdata len.</td>
            <td class="text-right" rowspan="1" colspan="1">14 + name len. + rdata len. + name overhead</td>
            <td class="text-right" rowspan="1" colspan="1">17 + name len. + rdata len. + name overhead</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">Standard RR with name rdata</td>
            <td class="text-right" rowspan="1" colspan="1">12 + name len. + rdata len.</td>
            <td class="text-right" rowspan="1" colspan="1">4</td>
            <td class="text-right" rowspan="1" colspan="1">14 + name len. + rdata len. + name overheads</td>
            <td class="text-right" rowspan="1" colspan="1">16 + name len. + rdata len. + name overheads</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">EDNS Opt Pseudo-RR</td>
            <td class="text-right" rowspan="1" colspan="1">11 + options</td>
            <td class="text-right" rowspan="1" colspan="1">2 + options</td>
            <td class="text-right" rowspan="1" colspan="1">6 + options</td>
            <td class="text-right" rowspan="1" colspan="1">14 + options</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">EDNS Option</td>
            <td class="text-right" rowspan="1" colspan="1">4 + value len.</td>
            <td class="text-right" rowspan="1" colspan="1">2 + value len.</td>
            <td class="text-right" rowspan="1" colspan="1">4 + value len.</td>
            <td class="text-right" rowspan="1" colspan="1">6 + value len.</td>
          </tr>
        </tbody>
      </table>
</div>
<span id="name-configuration-key-for"></span><div id="tab-cbor-comparison-key">
<table class="center" id="table-3">
        <caption>
<a href="#table-3" class="selfRef">Table 3</a>:
<a href="#name-configuration-key-for" class="selfRef">Configuration key for     <span class="cite xref">Table 2</span>
.</a>
        </caption>
<thead>
          <tr>
            <th class="text-left" rowspan="2" colspan="1">Item</th>
            <th class="text-center" rowspan="1" colspan="3">application/dns+cbor configuration</th>
          </tr>
          <tr>
            <th class="text-right" rowspan="1" colspan="1">best case</th>
            <th class="text-right" rowspan="1" colspan="1">realistic worst case</th>
            <th class="text-right" rowspan="1" colspan="1">theoretical worst case</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">Header (ID &amp; Flags)</td>
            <td class="text-right" rowspan="1" colspan="1">Flags elided</td>
            <td class="text-right" rowspan="1" colspan="1">QR, Opcode, AA, TC, or RD are set</td>
            <td class="text-right" rowspan="1" colspan="1">QR, Opcode, AA, TC, or RD are set</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">Count fields</td>
            <td class="text-right" rowspan="1" colspan="1">Encoded in CBOR array header</td>
            <td class="text-right" rowspan="1" colspan="1">Encoded in CBOR array header,        <br>
&gt;255 records in section</td>
            <td class="text-right" rowspan="1" colspan="1">Encoded in CBOR array header,        <br>
&gt;255 records in section</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">Question section</td>
            <td class="text-right" rowspan="1" colspan="1">Class, type, and name elided</td>
            <td class="text-right" rowspan="1" colspan="1">Type &gt; 255,        <br>
label len. &gt; 23</td>
            <td class="text-right" rowspan="1" colspan="1">Type &gt; 255,        <br>
Class &gt; 255,        <br>
label len. &gt; 23</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">Standard RR</td>
            <td class="text-right" rowspan="1" colspan="1">Class, type, and name elided,        <br>
rdata len. &lt; 24</td>
            <td class="text-right" rowspan="1" colspan="1">Type &gt; 255,        <br>
label len. &gt; 23        <br>
rdata len. &gt; 255</td>
            <td class="text-right" rowspan="1" colspan="1">Type &gt; 255,        <br>
Class &gt; 255,        <br>
label len. &gt; 23        <br>
rdata len. &gt; 255</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">Standard RR with name rdata</td>
            <td class="text-right" rowspan="1" colspan="1">Class, type, and name elided,        <br>
simple(i) with i &lt; 16</td>
            <td class="text-right" rowspan="1" colspan="1">Type &gt; 255,        <br>
label len. &gt; 23        <br>
name uncompressed</td>
            <td class="text-right" rowspan="1" colspan="1">Type &gt; 255,        <br>
Class &gt; 255,        <br>
label len. &gt; 23        <br>
name uncompressed</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">EDNS Opt Pseudo-RR</td>
            <td class="text-right" rowspan="1" colspan="1">All EDNS(0) fields elided</td>
            <td class="text-right" rowspan="1" colspan="1">Rcode &lt; 24,        <br>
DO flag set,        <br>
            </td>
            <td class="text-right" rowspan="1" colspan="1">UDP payload        <br>
len. &gt; 255        <br>
Rcode &gt; 255        <br>
Version &gt; 255        <br>
DO flag set</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">EDNS Option</td>
            <td class="text-right" rowspan="1" colspan="1">Code &lt; 24        <br>
Length &lt; 24</td>
            <td class="text-right" rowspan="1" colspan="1">Code &lt; 24        <br>
Length &gt; 255</td>
            <td class="text-right" rowspan="1" colspan="1">Code &gt; 255        <br>
Length &gt; 255</td>
          </tr>
        </tbody>
      </table>
</div>
</section>
</div>
<div id="change-log">
<section id="section-10">
      <h2 id="name-change-log">
<a href="#section-10" class="section-number selfRef">10. </a><a href="#name-change-log" class="section-name selfRef">Change Log</a>
      </h2>
<div id="since-draft-lenders-dns-cbor-15">
<section id="section-10.1">
        <h3 id="name-since-draft-lenders-dns-cbo">
<a href="#section-10.1" class="section-number selfRef">10.1. </a><a href="#name-since-draft-lenders-dns-cbo" class="section-name selfRef">Since <a href="https://datatracker.ietf.org/doc/html/draft-lenders-dns-cbor-15">draft-lenders-dns-cbor-15</a></a>
        </h3>
<ul class="normal">
<li class="normal" id="section-10.1-1.1">
            <p id="section-10.1-1.1.1">Add Vadim Goncharov as contributor<a href="#section-10.1-1.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-10.1-1.2">
            <p id="section-10.1-1.2.1">Add Mikolai Gütschow as co-author<a href="#section-10.1-1.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-10.1-1.3">
            <p id="section-10.1-1.3.1">Make options in OPT record a flat list of alternating key-value-pairs<a href="#section-10.1-1.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-10.1-1.4">
            <p id="section-10.1-1.4.1">Use e'' application extension in examples for better readability of RR types and clases<a href="#section-10.1-1.4.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-10.1-1.5">
            <p id="section-10.1-1.5.1">Pass on name compression<a href="#section-10.1-1.5.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-10.1-1.5.2.1">
                <p id="section-10.1-1.5.2.1.1">TBD28259 now appends, rather than prepends to existing packing tables to allow for single pass
decoders with minimum state.<a href="#section-10.1-1.5.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-10.1-1.5.2.2">
                <p id="section-10.1-1.5.2.2.1">Consequently, disallow inner table setup tags to TBD28259, as that would increase complexity of
both decoders and encoders<a href="#section-10.1-1.5.2.2.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-10.1-1.5.2.3">
                <p id="section-10.1-1.5.2.3.1">Add considerations on maps within TBD28259 (see also #15)<a href="#section-10.1-1.5.2.3.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-10.1-1.5.2.4">
                <p id="section-10.1-1.5.2.4.1">Clarify implicit nature with <code>packed</code><a href="#section-10.1-1.5.2.4.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-10.1-1.5.2.5">
                <p id="section-10.1-1.5.2.5.1">Provide actual DNS examples<a href="#section-10.1-1.5.2.5.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-10.1-1.5.2.6">
                <p id="section-10.1-1.5.2.6.1">Add example decoder as pseudo-code<a href="#section-10.1-1.5.2.6.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
        </ul>
</section>
</div>
<div id="since-draft-lenders-dns-cbor-14">
<section id="section-10.2">
        <h3 id="name-since-draft-lenders-dns-cbor">
<a href="#section-10.2" class="section-number selfRef">10.2. </a><a href="#name-since-draft-lenders-dns-cbor" class="section-name selfRef">Since <a href="https://datatracker.ietf.org/doc/html/draft-lenders-dns-cbor-14">draft-lenders-dns-cbor-14</a></a>
        </h3>
<ul class="normal">
<li class="normal" id="section-10.2-1.1">
            <p id="section-10.2-1.1.1">Correction and nits<a href="#section-10.2-1.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-10.2-1.2">
            <p id="section-10.2-1.2.1">Explicitly state which integration tags are in use<a href="#section-10.2-1.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-10.2-1.3">
            <p id="section-10.2-1.3.1">Add binary examples in CBOR-pretty<a href="#section-10.2-1.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-10.2-1.4">
            <p id="section-10.2-1.4.1">Unify formatting for and mention explicitly application/dns+cbor from the top<a href="#section-10.2-1.4.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-10.2-1.5">
            <p id="section-10.2-1.5.1">Explicitly define behavior for query[0] = True in response text<a href="#section-10.2-1.5.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-10.2-1.6">
            <p id="section-10.2-1.6.1">Clarifications around media type parameter <code>packed=1</code><a href="#section-10.2-1.6.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-10.2-1.7">
            <p id="section-10.2-1.7.1">Remove TBD reference (it never came to be)<a href="#section-10.2-1.7.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="since-draft-lenders-dns-cbor-13">
<section id="section-10.3">
        <h3 id="name-since-draft-lenders-dns-cbor-">
<a href="#section-10.3" class="section-number selfRef">10.3. </a><a href="#name-since-draft-lenders-dns-cbor-" class="section-name selfRef">Since <a href="https://datatracker.ietf.org/doc/html/draft-lenders-dns-cbor-13">draft-lenders-dns-cbor-13</a></a>
        </h3>
<ul class="normal">
<li class="normal" id="section-10.3-1.1">
            <p id="section-10.3-1.1.1">Make use of splicing integration tag 1115<a href="#section-10.3-1.1.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-10.3-1.1.2.1">
                <p id="section-10.3-1.1.2.1.1">Make domain names flat text string sequences again<a href="#section-10.3-1.1.2.1.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
          <li class="normal" id="section-10.3-1.2">
            <p id="section-10.3-1.2.1">Add capability to summarize rrsets<a href="#section-10.3-1.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-10.3-1.3">
            <p id="section-10.3-1.3.1">Provide extension point for IP addresses<a href="#section-10.3-1.3.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="since-draft-lenders-dns-cbor-12">
<section id="section-10.4">
        <h3 id="name-since-draft-lenders-dns-cbor-1">
<a href="#section-10.4" class="section-number selfRef">10.4. </a><a href="#name-since-draft-lenders-dns-cbor-1" class="section-name selfRef">Since <a href="https://datatracker.ietf.org/doc/html/draft-lenders-dns-cbor-12">draft-lenders-dns-cbor-12</a></a>
        </h3>
<ul class="normal">
<li class="normal" id="section-10.4-1.1">
            <p id="section-10.4-1.1.1">Fix bug in packed examples<a href="#section-10.4-1.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-10.4-1.2">
            <p id="section-10.4-1.2.1">Improve compression examples for clarity<a href="#section-10.4-1.2.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="since-draft-lenders-dns-cbor-11">
<section id="section-10.5">
        <h3 id="name-since-draft-lenders-dns-cbor-11">
<a href="#section-10.5" class="section-number selfRef">10.5. </a><a href="#name-since-draft-lenders-dns-cbor-11" class="section-name selfRef">Since <a href="https://datatracker.ietf.org/doc/html/draft-lenders-dns-cbor-11">draft-lenders-dns-cbor-11</a></a>
        </h3>
<ul class="normal">
<li class="normal" id="section-10.5-1.1">
            <p id="section-10.5-1.1.1">Update repo links to cbor-wg org in draft<a href="#section-10.5-1.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-10.5-1.2">
            <p id="section-10.5-1.2.1"><code>s/CBOR-packed/Packed CBOR/</code><a href="#section-10.5-1.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-10.5-1.3">
            <p id="section-10.5-1.3.1">Small pass on wording<a href="#section-10.5-1.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-10.5-1.4">
            <p id="section-10.5-1.4.1">Remove commented-out parts<a href="#section-10.5-1.4.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-10.5-1.5">
            <p id="section-10.5-1.5.1">Make name compression be based on Packed CBOR<a href="#section-10.5-1.5.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="since-draft-lenders-dns-cbor-10">
<section id="section-10.6">
        <h3 id="name-since-draft-lenders-dns-cbor-10">
<a href="#section-10.6" class="section-number selfRef">10.6. </a><a href="#name-since-draft-lenders-dns-cbor-10" class="section-name selfRef">Since <a href="https://datatracker.ietf.org/doc/html/draft-lenders-dns-cbor-10">draft-lenders-dns-cbor-10</a></a>
        </h3>
<ul class="normal">
<li class="normal" id="section-10.6-1.1">
            <p id="section-10.6-1.1.1">Address IANA #1392416 early review<a href="#section-10.6-1.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-10.6-1.2">
            <p id="section-10.6-1.2.1">Fix external section references<a href="#section-10.6-1.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-10.6-1.3">
            <p id="section-10.6-1.3.1">Update implementation status<a href="#section-10.6-1.3.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="since-draft-lenders-dns-cbor-09">
<section id="section-10.7">
        <h3 id="name-since-draft-lenders-dns-cbor-0">
<a href="#section-10.7" class="section-number selfRef">10.7. </a><a href="#name-since-draft-lenders-dns-cbor-0" class="section-name selfRef">Since <a href="https://datatracker.ietf.org/doc/html/draft-lenders-dns-cbor-09">draft-lenders-dns-cbor-09</a></a>
        </h3>
<ul class="normal">
<li class="normal" id="section-10.7-1.1">
            <p id="section-10.7-1.1.1">Add recommendation on label encoding<a href="#section-10.7-1.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-10.7-1.2">
            <p id="section-10.7-1.2.1">Provide extension points<a href="#section-10.7-1.2.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-10.7-1.2.2.1">
                <p id="section-10.7-1.2.2.1.1">Mark dns-rr specifically as extension point<a href="#section-10.7-1.2.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-10.7-1.2.2.2">
                <p id="section-10.7-1.2.2.2.1">Provide extension points for parameter values (options and svc-params)<a href="#section-10.7-1.2.2.2.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
          <li class="normal" id="section-10.7-1.3">
            <p id="section-10.7-1.3.1">Point out CBOR-packed needs to be unpacked when identifying names<a href="#section-10.7-1.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-10.7-1.4">
            <p id="section-10.7-1.4.1">Distinguish from C-DNS <span>[<a href="#RFC8618" class="cite xref">RFC8618</a>]</span><a href="#section-10.7-1.4.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-10.7-1.5">
            <p id="section-10.7-1.5.1">State objectives in introduction<a href="#section-10.7-1.5.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-10.7-1.6">
            <p id="section-10.7-1.6.1">Fix nits and typos<a href="#section-10.7-1.6.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="since-draft-lenders-dns-cbor-08">
<section id="section-10.8">
        <h3 id="name-since-draft-lenders-dns-cbor-08">
<a href="#section-10.8" class="section-number selfRef">10.8. </a><a href="#name-since-draft-lenders-dns-cbor-08" class="section-name selfRef">Since <a href="https://datatracker.ietf.org/doc/html/draft-lenders-dns-cbor-08">draft-lenders-dns-cbor-08</a></a>
        </h3>
<ul class="normal">
<li class="normal" id="section-10.8-1.1">
            <p id="section-10.8-1.1.1">Clarify why question section was designed the way it is<a href="#section-10.8-1.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-10.8-1.2">
            <p id="section-10.8-1.2.1">Add answer section to queries for Known Answers in mDNS<a href="#section-10.8-1.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-10.8-1.3">
            <p id="section-10.8-1.3.1">Express names as sequence of labels<a href="#section-10.8-1.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-10.8-1.4">
            <p id="section-10.8-1.4.1">Provide dedicated types for more structured RDATA<a href="#section-10.8-1.4.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-10.8-1.5">
            <p id="section-10.8-1.5.1">Add RFC1035-like name compression<a href="#section-10.8-1.5.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-10.8-1.6">
            <p id="section-10.8-1.6.1">Add switching boolean to query message to explicitly have question present in response<a href="#section-10.8-1.6.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-10.8-1.7">
            <p id="section-10.8-1.7.1">Make EDNS options a map<a href="#section-10.8-1.7.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-10.8-1.8">
            <p id="section-10.8-1.8.1">Update examples and comparison table in appendices<a href="#section-10.8-1.8.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-10.8-1.9">
            <p id="section-10.8-1.9.1">Update implementation section<a href="#section-10.8-1.9.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="since-draft-lenders-dns-cbor-07">
<section id="section-10.9">
        <h3 id="name-since-draft-lenders-dns-cbor-07">
<a href="#section-10.9" class="section-number selfRef">10.9. </a><a href="#name-since-draft-lenders-dns-cbor-07" class="section-name selfRef">Since <a href="https://datatracker.ietf.org/doc/html/draft-lenders-dns-cbor-07">draft-lenders-dns-cbor-07</a></a>
        </h3>
<ul class="normal">
<li class="normal" id="section-10.9-1.1">
            <p id="section-10.9-1.1.1">Add <a href="#sec_comparison-to-classic-dns" class="auto internal xref">Section 9</a> with comparison to classic DNS wire format<a href="#section-10.9-1.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-10.9-1.2">
            <p id="section-10.9-1.2.1">"wire format" -&gt; "classic DNS wire format"<a href="#section-10.9-1.2.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="since-draft-lenders-dns-cbor-06">
<section id="section-10.10">
        <h3 id="name-since-draft-lenders-dns-cbor-06">
<a href="#section-10.10" class="section-number selfRef">10.10. </a><a href="#name-since-draft-lenders-dns-cbor-06" class="section-name selfRef">Since <a href="https://datatracker.ietf.org/doc/html/draft-lenders-dns-cbor-06">draft-lenders-dns-cbor-06</a></a>
        </h3>
<ul class="normal">
<li class="normal" id="section-10.10-1.1">
            <p id="section-10.10-1.1.1">Fixes wording and spelling mistakes<a href="#section-10.10-1.1.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="since-draft-lenders-dns-cbor-05">
<section id="section-10.11">
        <h3 id="name-since-draft-lenders-dns-cbor-05">
<a href="#section-10.11" class="section-number selfRef">10.11. </a><a href="#name-since-draft-lenders-dns-cbor-05" class="section-name selfRef">Since <a href="https://datatracker.ietf.org/doc/html/draft-lenders-dns-cbor-05">draft-lenders-dns-cbor-05</a></a>
        </h3>
<ul class="normal">
<li class="normal" id="section-10.11-1.1">
            <p id="section-10.11-1.1.1">Fix <a href="#cf-app-d-c" class="auto internal xref">Section 7.2.1</a> title<a href="#section-10.11-1.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-10.11-1.2">
            <p id="section-10.11-1.2.1">Amend for capability to carry more than one question<a href="#section-10.11-1.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-10.11-1.3">
            <p id="section-10.11-1.3.1">Hint at future of name compression in later draft versions<a href="#section-10.11-1.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-10.11-1.4">
            <p id="section-10.11-1.4.1">Use canonical name for CBOR-packed<a href="#section-10.11-1.4.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="since-draft-lenders-dns-cbor-04">
<section id="section-10.12">
        <h3 id="name-since-draft-lenders-dns-cbor-04">
<a href="#section-10.12" class="section-number selfRef">10.12. </a><a href="#name-since-draft-lenders-dns-cbor-04" class="section-name selfRef">Since <a href="https://datatracker.ietf.org/doc/html/draft-lenders-dns-cbor-04">draft-lenders-dns-cbor-04</a></a>
        </h3>
<ul class="normal">
<li class="normal" id="section-10.12-1.1">
            <p id="section-10.12-1.1.1">Add Implementation Status section<a href="#section-10.12-1.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-10.12-1.2">
            <p id="section-10.12-1.2.1">Remove int as representation for rdata<a href="#section-10.12-1.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-10.12-1.3">
            <p id="section-10.12-1.3.1">Add note on representation of more structured rdata<a href="#section-10.12-1.3.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="since-draft-lenders-dns-cbor-03">
<section id="section-10.13">
        <h3 id="name-since-draft-lenders-dns-cbor-03">
<a href="#section-10.13" class="section-number selfRef">10.13. </a><a href="#name-since-draft-lenders-dns-cbor-03" class="section-name selfRef">Since <a href="https://datatracker.ietf.org/doc/html/draft-lenders-dns-cbor-03">draft-lenders-dns-cbor-03</a></a>
        </h3>
<ul class="normal">
<li class="normal" id="section-10.13-1.1">
            <p id="section-10.13-1.1.1">Provide format description for EDNS OPT Pseudo-RRs<a href="#section-10.13-1.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-10.13-1.2">
            <p id="section-10.13-1.2.1">Simplify CDDL to more idiomatic style<a href="#section-10.13-1.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-10.13-1.3">
            <p id="section-10.13-1.3.1">Remove DNS transaction IDs<a href="#section-10.13-1.3.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="since-draft-lenders-dns-cbor-02">
<section id="section-10.14">
        <h3 id="name-since-draft-lenders-dns-cbor-02">
<a href="#section-10.14" class="section-number selfRef">10.14. </a><a href="#name-since-draft-lenders-dns-cbor-02" class="section-name selfRef">Since <a href="https://datatracker.ietf.org/doc/html/draft-lenders-dns-cbor-02">draft-lenders-dns-cbor-02</a></a>
        </h3>
<ul class="normal">
<li class="normal" id="section-10.14-1.1">
            <p id="section-10.14-1.1.1">Add Discussion section and note on compression<a href="#section-10.14-1.1.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="since-draft-lenders-dns-cbor-01">
<section id="section-10.15">
        <h3 id="name-since-draft-lenders-dns-cbor-01">
<a href="#section-10.15" class="section-number selfRef">10.15. </a><a href="#name-since-draft-lenders-dns-cbor-01" class="section-name selfRef">Since <a href="https://datatracker.ietf.org/doc/html/draft-lenders-dns-cbor-01">draft-lenders-dns-cbor-01</a></a>
        </h3>
<ul class="normal">
<li class="normal" id="section-10.15-1.1">
            <p id="section-10.15-1.1.1">Use MIME type parameter for packed instead of own MIME type<a href="#section-10.15-1.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-10.15-1.2">
            <p id="section-10.15-1.2.1">Update definitions to accommodate for TID and flags, as well as more sections in query<a href="#section-10.15-1.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-10.15-1.3">
            <p id="section-10.15-1.3.1">Clarify fallback to wire-format<a href="#section-10.15-1.3.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="since-draft-lenders-dns-cbor-00">
<section id="section-10.16">
        <h3 id="name-since-draft-lenders-dns-cbor-00">
<a href="#section-10.16" class="section-number selfRef">10.16. </a><a href="#name-since-draft-lenders-dns-cbor-00" class="section-name selfRef">Since <a href="https://datatracker.ietf.org/doc/html/draft-lenders-dns-cbor-00">draft-lenders-dns-cbor-00</a></a>
        </h3>
<ul class="normal">
<li class="normal" id="section-10.16-1.1">
            <p id="section-10.16-1.1.1">Add support for DNS transaction IDs<a href="#section-10.16-1.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-10.16-1.2">
            <p id="section-10.16-1.2.1">Name and Address compression utilizing CBOR-packed<a href="#section-10.16-1.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-10.16-1.3">
            <p id="section-10.16-1.3.1">Minor fixes to CBOR EDN and CDDL<a href="#section-10.16-1.3.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
</section>
</div>
<div id="acknowledgments">
<section id="section-11">
      <h2 id="name-acknowledgments">
<a href="#name-acknowledgments" class="section-name selfRef">Acknowledgments</a>
      </h2>
<p id="section-11-1">We want to extend special thanks to Christian Amsüss for his input in the brainstorming session that resulted in the current form of name compression.<a href="#section-11-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sec-combined-references">
<section id="section-12">
      <h2 id="name-references">
<a href="#name-references" class="section-name selfRef">References</a>
      </h2>
<div id="sec-normative-references">
<section id="section-12.1">
        <h3 id="name-normative-references">
<a href="#name-normative-references" class="section-name selfRef">Normative References</a>
        </h3>
<dl class="references">
<dt id="I-D.ietf-cbor-edn-e-ref">[I-D.ietf-cbor-edn-e-ref]</dt>
        <dd>
<span class="refAuthor">Bormann, C.</span>, <span class="refTitle">"External References to Values in CBOR Diagnostic Notation (EDN)"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-cbor-edn-e-ref-02</span>, <time datetime="2025-07-02" class="refDate">2 July 2025</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-ietf-cbor-edn-e-ref-02">https://datatracker.ietf.org/doc/html/draft-ietf-cbor-edn-e-ref-02</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-cbor-edn-literals">[I-D.ietf-cbor-edn-literals]</dt>
        <dd>
<span class="refAuthor">Bormann, C.</span>, <span class="refTitle">"CBOR Extended Diagnostic Notation (EDN)"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-cbor-edn-literals-19</span>, <time datetime="2025-10-16" class="refDate">16 October 2025</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-ietf-cbor-edn-literals-19">https://datatracker.ietf.org/doc/html/draft-ietf-cbor-edn-literals-19</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-cbor-packed">[I-D.ietf-cbor-packed]</dt>
        <dd>
<span class="refAuthor">Bormann, C.</span> and <span class="refAuthor">M. Gütschow</span>, <span class="refTitle">"Packed CBOR"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-cbor-packed-19</span>, <time datetime="2026-02-02" class="refDate">2 February 2026</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-ietf-cbor-packed-19">https://datatracker.ietf.org/doc/html/draft-ietf-cbor-packed-19</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="IANA.cbor-tags">[IANA.cbor-tags]</dt>
        <dd>
<span class="refAuthor">IANA</span>, <span class="refTitle">"Concise Binary Object Representation (CBOR) Tags"</span>, <span>&lt;<a href="https://www.iana.org/assignments/cbor-tags">https://www.iana.org/assignments/cbor-tags</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC1035">[RFC1035]</dt>
        <dd>
<span class="refAuthor">Mockapetris, P.</span>, <span class="refTitle">"Domain names - implementation and specification"</span>, <span class="seriesInfo">STD 13</span>, <span class="seriesInfo">RFC 1035</span>, <span class="seriesInfo">DOI 10.17487/RFC1035</span>, <time datetime="1987-11" class="refDate">November 1987</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc1035">https://www.rfc-editor.org/rfc/rfc1035</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2119">[RFC2119]</dt>
        <dd>
<span class="refAuthor">Bradner, S.</span>, <span class="refTitle">"Key words for use in RFCs to Indicate Requirement Levels"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 2119</span>, <span class="seriesInfo">DOI 10.17487/RFC2119</span>, <time datetime="1997-03" class="refDate">March 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc2119">https://www.rfc-editor.org/rfc/rfc2119</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2782">[RFC2782]</dt>
        <dd>
<span class="refAuthor">Gulbrandsen, A.</span>, <span class="refAuthor">Vixie, P.</span>, and <span class="refAuthor">L. Esibov</span>, <span class="refTitle">"A DNS RR for specifying the location of services (DNS SRV)"</span>, <span class="seriesInfo">RFC 2782</span>, <span class="seriesInfo">DOI 10.17487/RFC2782</span>, <time datetime="2000-02" class="refDate">February 2000</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc2782">https://www.rfc-editor.org/rfc/rfc2782</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC3596">[RFC3596]</dt>
        <dd>
<span class="refAuthor">Thomson, S.</span>, <span class="refAuthor">Huitema, C.</span>, <span class="refAuthor">Ksinant, V.</span>, and <span class="refAuthor">M. Souissi</span>, <span class="refTitle">"DNS Extensions to Support IP Version 6"</span>, <span class="seriesInfo">STD 88</span>, <span class="seriesInfo">RFC 3596</span>, <span class="seriesInfo">DOI 10.17487/RFC3596</span>, <time datetime="2003-10" class="refDate">October 2003</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc3596">https://www.rfc-editor.org/rfc/rfc3596</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5891">[RFC5891]</dt>
        <dd>
<span class="refAuthor">Klensin, J.</span>, <span class="refTitle">"Internationalized Domain Names in Applications (IDNA): Protocol"</span>, <span class="seriesInfo">RFC 5891</span>, <span class="seriesInfo">DOI 10.17487/RFC5891</span>, <time datetime="2010-08" class="refDate">August 2010</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc5891">https://www.rfc-editor.org/rfc/rfc5891</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6838">[RFC6838]</dt>
        <dd>
<span class="refAuthor">Freed, N.</span>, <span class="refAuthor">Klensin, J.</span>, and <span class="refAuthor">T. Hansen</span>, <span class="refTitle">"Media Type Specifications and Registration Procedures"</span>, <span class="seriesInfo">BCP 13</span>, <span class="seriesInfo">RFC 6838</span>, <span class="seriesInfo">DOI 10.17487/RFC6838</span>, <time datetime="2013-01" class="refDate">January 2013</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc6838">https://www.rfc-editor.org/rfc/rfc6838</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6891">[RFC6891]</dt>
        <dd>
<span class="refAuthor">Damas, J.</span>, <span class="refAuthor">Graff, M.</span>, and <span class="refAuthor">P. Vixie</span>, <span class="refTitle">"Extension Mechanisms for DNS (EDNS(0))"</span>, <span class="seriesInfo">STD 75</span>, <span class="seriesInfo">RFC 6891</span>, <span class="seriesInfo">DOI 10.17487/RFC6891</span>, <time datetime="2013-04" class="refDate">April 2013</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc6891">https://www.rfc-editor.org/rfc/rfc6891</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7252">[RFC7252]</dt>
        <dd>
<span class="refAuthor">Shelby, Z.</span>, <span class="refAuthor">Hartke, K.</span>, and <span class="refAuthor">C. Bormann</span>, <span class="refTitle">"The Constrained Application Protocol (CoAP)"</span>, <span class="seriesInfo">RFC 7252</span>, <span class="seriesInfo">DOI 10.17487/RFC7252</span>, <time datetime="2014-06" class="refDate">June 2014</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc7252">https://www.rfc-editor.org/rfc/rfc7252</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8174">[RFC8174]</dt>
        <dd>
<span class="refAuthor">Leiba, B.</span>, <span class="refTitle">"Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 8174</span>, <span class="seriesInfo">DOI 10.17487/RFC8174</span>, <time datetime="2017-05" class="refDate">May 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8174">https://www.rfc-editor.org/rfc/rfc8174</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8610">[RFC8610]</dt>
        <dd>
<span class="refAuthor">Birkholz, H.</span>, <span class="refAuthor">Vigano, C.</span>, and <span class="refAuthor">C. Bormann</span>, <span class="refTitle">"Concise Data Definition Language (CDDL): A Notational Convention to Express Concise Binary Object Representation (CBOR) and JSON Data Structures"</span>, <span class="seriesInfo">RFC 8610</span>, <span class="seriesInfo">DOI 10.17487/RFC8610</span>, <time datetime="2019-06" class="refDate">June 2019</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8610">https://www.rfc-editor.org/rfc/rfc8610</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8949">[RFC8949]</dt>
        <dd>
<span class="refAuthor">Bormann, C.</span> and <span class="refAuthor">P. Hoffman</span>, <span class="refTitle">"Concise Binary Object Representation (CBOR)"</span>, <span class="seriesInfo">STD 94</span>, <span class="seriesInfo">RFC 8949</span>, <span class="seriesInfo">DOI 10.17487/RFC8949</span>, <time datetime="2020-12" class="refDate">December 2020</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8949">https://www.rfc-editor.org/rfc/rfc8949</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9460">[RFC9460]</dt>
      <dd>
<span class="refAuthor">Schwartz, B.</span>, <span class="refAuthor">Bishop, M.</span>, and <span class="refAuthor">E. Nygren</span>, <span class="refTitle">"Service Binding and Parameter Specification via the DNS (SVCB and HTTPS Resource Records)"</span>, <span class="seriesInfo">RFC 9460</span>, <span class="seriesInfo">DOI 10.17487/RFC9460</span>, <time datetime="2023-11" class="refDate">November 2023</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc9460">https://www.rfc-editor.org/rfc/rfc9460</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</div>
<div id="sec-informative-references">
<section id="section-12.2">
        <h3 id="name-informative-references">
<a href="#name-informative-references" class="section-name selfRef">Informative References</a>
        </h3>
<dl class="references">
<dt id="I-D.ietf-core-dns-over-coap">[I-D.ietf-core-dns-over-coap]</dt>
        <dd>
<span class="refAuthor">Lenders, M. S.</span>, <span class="refAuthor">Amsüss, C.</span>, <span class="refAuthor">Gündoğan, C.</span>, <span class="refAuthor">Schmidt, T. C.</span>, and <span class="refAuthor">M. Wählisch</span>, <span class="refTitle">"DNS over CoAP (DoC)"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-core-dns-over-coap-20</span>, <time datetime="2025-09-16" class="refDate">16 September 2025</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-ietf-core-dns-over-coap-20">https://datatracker.ietf.org/doc/html/draft-ietf-core-dns-over-coap-20</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4944">[RFC4944]</dt>
        <dd>
<span class="refAuthor">Montenegro, G.</span>, <span class="refAuthor">Kushalnagar, N.</span>, <span class="refAuthor">Hui, J.</span>, and <span class="refAuthor">D. Culler</span>, <span class="refTitle">"Transmission of IPv6 Packets over IEEE 802.15.4 Networks"</span>, <span class="seriesInfo">RFC 4944</span>, <span class="seriesInfo">DOI 10.17487/RFC4944</span>, <time datetime="2007-09" class="refDate">September 2007</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc4944">https://www.rfc-editor.org/rfc/rfc4944</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6282">[RFC6282]</dt>
        <dd>
<span class="refAuthor">Hui, J., Ed.</span> and <span class="refAuthor">P. Thubert</span>, <span class="refTitle">"Compression Format for IPv6 Datagrams over IEEE 802.15.4-Based Networks"</span>, <span class="seriesInfo">RFC 6282</span>, <span class="seriesInfo">DOI 10.17487/RFC6282</span>, <time datetime="2011-09" class="refDate">September 2011</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc6282">https://www.rfc-editor.org/rfc/rfc6282</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6762">[RFC6762]</dt>
        <dd>
<span class="refAuthor">Cheshire, S.</span> and <span class="refAuthor">M. Krochmal</span>, <span class="refTitle">"Multicast DNS"</span>, <span class="seriesInfo">RFC 6762</span>, <span class="seriesInfo">DOI 10.17487/RFC6762</span>, <time datetime="2013-02" class="refDate">February 2013</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc6762">https://www.rfc-editor.org/rfc/rfc6762</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7228">[RFC7228]</dt>
        <dd>
<span class="refAuthor">Bormann, C.</span>, <span class="refAuthor">Ersue, M.</span>, and <span class="refAuthor">A. Keranen</span>, <span class="refTitle">"Terminology for Constrained-Node Networks"</span>, <span class="seriesInfo">RFC 7228</span>, <span class="seriesInfo">DOI 10.17487/RFC7228</span>, <time datetime="2014-05" class="refDate">May 2014</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc7228">https://www.rfc-editor.org/rfc/rfc7228</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7942">[RFC7942]</dt>
        <dd>
<span class="refAuthor">Sheffer, Y.</span> and <span class="refAuthor">A. Farrel</span>, <span class="refTitle">"Improving Awareness of Running Code: The Implementation Status Section"</span>, <span class="seriesInfo">BCP 205</span>, <span class="seriesInfo">RFC 7942</span>, <span class="seriesInfo">DOI 10.17487/RFC7942</span>, <time datetime="2016-07" class="refDate">July 2016</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc7942">https://www.rfc-editor.org/rfc/rfc7942</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8484">[RFC8484]</dt>
        <dd>
<span class="refAuthor">Hoffman, P.</span> and <span class="refAuthor">P. McManus</span>, <span class="refTitle">"DNS Queries over HTTPS (DoH)"</span>, <span class="seriesInfo">RFC 8484</span>, <span class="seriesInfo">DOI 10.17487/RFC8484</span>, <time datetime="2018-10" class="refDate">October 2018</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8484">https://www.rfc-editor.org/rfc/rfc8484</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8499">[RFC8499]</dt>
        <dd>
<span class="refAuthor">Hoffman, P.</span>, <span class="refAuthor">Sullivan, A.</span>, and <span class="refAuthor">K. Fujiwara</span>, <span class="refTitle">"DNS Terminology"</span>, <span class="seriesInfo">RFC 8499</span>, <span class="seriesInfo">DOI 10.17487/RFC8499</span>, <time datetime="2019-01" class="refDate">January 2019</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8499">https://www.rfc-editor.org/rfc/rfc8499</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8618">[RFC8618]</dt>
        <dd>
<span class="refAuthor">Dickinson, J.</span>, <span class="refAuthor">Hague, J.</span>, <span class="refAuthor">Dickinson, S.</span>, <span class="refAuthor">Manderson, T.</span>, and <span class="refAuthor">J. Bond</span>, <span class="refTitle">"Compacted-DNS (C-DNS): A Format for DNS Packet Capture"</span>, <span class="seriesInfo">RFC 8618</span>, <span class="seriesInfo">DOI 10.17487/RFC8618</span>, <time datetime="2019-09" class="refDate">September 2019</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8618">https://www.rfc-editor.org/rfc/rfc8618</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8724">[RFC8724]</dt>
        <dd>
<span class="refAuthor">Minaburo, A.</span>, <span class="refAuthor">Toutain, L.</span>, <span class="refAuthor">Gomez, C.</span>, <span class="refAuthor">Barthel, D.</span>, and <span class="refAuthor">JC. Zuniga</span>, <span class="refTitle">"SCHC: Generic Framework for Static Context Header Compression and Fragmentation"</span>, <span class="seriesInfo">RFC 8724</span>, <span class="seriesInfo">DOI 10.17487/RFC8724</span>, <time datetime="2020-04" class="refDate">April 2020</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8724">https://www.rfc-editor.org/rfc/rfc8724</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8824">[RFC8824]</dt>
        <dd>
<span class="refAuthor">Minaburo, A.</span>, <span class="refAuthor">Toutain, L.</span>, and <span class="refAuthor">R. Andreasen</span>, <span class="refTitle">"Static Context Header Compression (SCHC) for the Constrained Application Protocol (CoAP)"</span>, <span class="seriesInfo">RFC 8824</span>, <span class="seriesInfo">DOI 10.17487/RFC8824</span>, <time datetime="2021-06" class="refDate">June 2021</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8824">https://www.rfc-editor.org/rfc/rfc8824</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8945">[RFC8945]</dt>
        <dd>
<span class="refAuthor">Dupont, F.</span>, <span class="refAuthor">Morris, S.</span>, <span class="refAuthor">Vixie, P.</span>, <span class="refAuthor">Eastlake 3rd, D.</span>, <span class="refAuthor">Gudmundsson, O.</span>, and <span class="refAuthor">B. Wellington</span>, <span class="refTitle">"Secret Key Transaction Authentication for DNS (TSIG)"</span>, <span class="seriesInfo">STD 93</span>, <span class="seriesInfo">RFC 8945</span>, <span class="seriesInfo">DOI 10.17487/RFC8945</span>, <time datetime="2020-11" class="refDate">November 2020</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8945">https://www.rfc-editor.org/rfc/rfc8945</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9110">[RFC9110]</dt>
        <dd>
<span class="refAuthor">Fielding, R., Ed.</span>, <span class="refAuthor">Nottingham, M., Ed.</span>, and <span class="refAuthor">J. Reschke, Ed.</span>, <span class="refTitle">"HTTP Semantics"</span>, <span class="seriesInfo">STD 97</span>, <span class="seriesInfo">RFC 9110</span>, <span class="seriesInfo">DOI 10.17487/RFC9110</span>, <time datetime="2022-06" class="refDate">June 2022</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc9110">https://www.rfc-editor.org/rfc/rfc9110</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9619">[RFC9619]</dt>
      <dd>
<span class="refAuthor">Bellis, R.</span> and <span class="refAuthor">J. Abley</span>, <span class="refTitle">"In the DNS, QDCOUNT Is (Usually) One"</span>, <span class="seriesInfo">RFC 9619</span>, <span class="seriesInfo">DOI 10.17487/RFC9619</span>, <time datetime="2024-07" class="refDate">July 2024</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc9619">https://www.rfc-editor.org/rfc/rfc9619</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</div>
</section>
</div>
<div id="contributors">
<section id="appendix-A">
      <h2 id="name-contributors">
<a href="#name-contributors" class="section-name selfRef">Contributors</a>
      </h2>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Vadim Goncharov</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:vadimnuclight@gmail.com" class="email">vadimnuclight@gmail.com</a>
</div>
</address>
</section>
</div>
<div id="authors-addresses">
<section id="appendix-B">
      <h2 id="name-authors-addresses">
<a href="#name-authors-addresses" class="section-name selfRef">Authors' Addresses</a>
      </h2>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Martine Sophie Lenders</span></div>
<div dir="auto" class="left"><span class="org">TUD Dresden University of Technology</span></div>
<div dir="auto" class="left"><span class="street-address">Helmholtzstr. 10</span></div>
<div dir="auto" class="left">
<span class="postal-code">D-01069</span> <span class="locality">Dresden</span>
</div>
<div dir="auto" class="left"><span class="country-name">Germany</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:martine.lenders@tu-dresden.de" class="email">martine.lenders@tu-dresden.de</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Carsten Bormann</span></div>
<div dir="auto" class="left"><span class="org">Universität Bremen TZI</span></div>
<div dir="auto" class="left"><span class="street-address">Postfach 330440</span></div>
<div dir="auto" class="left">
<span class="postal-code">D-28359</span> <span class="locality">Bremen</span>
</div>
<div dir="auto" class="left"><span class="country-name">Germany</span></div>
<div class="tel">
<span>Phone:</span>
<a href="tel:+49-421-218-63921" class="tel">+49-421-218-63921</a>
</div>
<div class="email">
<span>Email:</span>
<a href="mailto:cabo@tzi.org" class="email">cabo@tzi.org</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Mikolai Gütschow</span></div>
<div dir="auto" class="left"><span class="org">TUD Dresden University of Technology</span></div>
<div dir="auto" class="left"><span class="street-address">Helmholtzstr. 10</span></div>
<div dir="auto" class="left">
<span class="postal-code">D-01069</span> <span class="locality">Dresden</span>
</div>
<div dir="auto" class="left"><span class="country-name">Germany</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:mikolai.guetschow@tu-dresden.de" class="email">mikolai.guetschow@tu-dresden.de</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Thomas C. Schmidt</span></div>
<div dir="auto" class="left"><span class="org">HAW Hamburg</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:t.schmidt@haw-hamburg.de" class="email">t.schmidt@haw-hamburg.de</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Matthias Wählisch</span></div>
<div dir="auto" class="left"><span class="org">TUD Dresden University of Technology &amp; Barkhausen Institut</span></div>
<div dir="auto" class="left"><span class="street-address">Helmholtzstr. 10</span></div>
<div dir="auto" class="left">
<span class="postal-code">D-01069</span> <span class="locality">Dresden</span>
</div>
<div dir="auto" class="left"><span class="country-name">Germany</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:m.waehlisch@tu-dresden.de" class="email">m.waehlisch@tu-dresden.de</a>
</div>
</address>
</section>
</div>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>
</body>
</html>
